/*! Palindrom, version: 6.1.0 */
var PalindromDOM=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}([function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});class r extends Error{constructor(e){super(e),this.message=e}}class o extends r{constructor(e,t,n,r){if(!t||!["Server","Client"].includes(t))throw new TypeError("Error constructing PalindromConnectionError, `side` parameter is required and can either be 'Server' or 'Client'");super(e),this.side=t,this.message=`${t} error\n\t${e.replace(/\n/g,"\n\t")}`,this.url=n,this.connectionType=r}}},function(e,t){e.exports=URL},function(e,t){e.exports=WebSocket},function(e,t,n){var r=n(21),o=n(22);e.exports={JSONPatchQueue:r,JSONPatchQueueSynchronous:o,__esModule:!0}},function(e,t){var n=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},r=Object.prototype.hasOwnProperty;
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */function o(e,t){return r.call(e,t)}function i(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)o(e,r)&&t.push(r);return t}function s(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function a(e,t){var n;for(var r in e)if(o(e,r)){if(e[r]===t)return s(r)+"/";if("object"==typeof e[r]&&""!=(n=a(e[r],t)))return s(r)+"/"+n}return""}t.hasOwnProperty=o,t._objectKeys=i,t._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},t.isInteger=function(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0},t.escapePathComponent=s,t.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},t._getPathRecursive=a,t.getPath=function(e,t){if(e===t)return"/";var n=a(e,t);if(""===n)throw new Error("Object not found in root");return"/"+n},t.hasUndefined=function e(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0}else if("object"==typeof t){var o=i(t),s=o.length;for(n=0;n<s;n++)if(e(t[o[n]]))return!0}return!1};var c=function(e){function t(t,n,r,o,i){e.call(this,t),this.message=t,this.name=n,this.index=r,this.operation=o,this.tree=i}return n(t,e),t}(Error);t.PatchError=c},function(e,t){e.exports=null},function(e,t,n){n(8);var r=n(4),o=n(9),i=n(9);t.applyOperation=i.applyOperation,t.applyPatch=i.applyPatch,t.applyReducer=i.applyReducer,t.getValueByPointer=i.getValueByPointer,t.validate=i.validate,t.validator=i.validator;var s=n(4);t.JsonPatchError=s.PatchError,t.deepClone=s._deepClone,t.escapePathComponent=s.escapePathComponent,t.unescapePathComponent=s.unescapePathComponent;var a=new WeakMap,c=function(){return function(e){this.observers=new Map,this.obj=e}}(),h=function(){return function(e,t){this.callback=e,this.observer=t}}();function l(e){var t=a.get(e.object);p(t.value,e.object,e.patches,""),e.patches.length&&o.applyPatch(t.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,t,n,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=r._objectKeys(t),s=r._objectKeys(e),a=!1,c=s.length-1;c>=0;c--){var h=e[u=s[c]];if(!r.hasOwnProperty(t,u)||void 0===t[u]&&void 0!==h&&!1===Array.isArray(t))n.push({op:"remove",path:o+"/"+r.escapePathComponent(u)}),a=!0;else{var l=t[u];"object"==typeof h&&null!=h&&"object"==typeof l&&null!=l?p(h,l,n,o+"/"+r.escapePathComponent(u)):h!==l&&(!0,n.push({op:"replace",path:o+"/"+r.escapePathComponent(u),value:r._deepClone(l)}))}}if(a||i.length!=s.length)for(c=0;c<i.length;c++){var u=i[c];r.hasOwnProperty(e,u)||void 0===t[u]||n.push({op:"add",path:o+"/"+r.escapePathComponent(u),value:r._deepClone(t[u])})}}}t.unobserve=function(e,t){t.unobserve()},t.observe=function(e,t){var n,o=function(e){return a.get(e)}(e);if(o){var i=function(e,t){return e.observers.get(t)}(o,t);n=i&&i.observer}else o=new c(e),a.set(e,o);if(n)return n;if(n={},o.value=r._deepClone(e),t){n.callback=t,n.next=null;var s=function(){l(n)},p=function(){clearTimeout(n.next),n.next=setTimeout(s)};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mouseup",p),window.addEventListener("keyup",p),window.addEventListener("mousedown",p),window.addEventListener("keydown",p),window.addEventListener("change",p)):(document.documentElement.attachEvent("onmouseup",p),document.documentElement.attachEvent("onkeyup",p),document.documentElement.attachEvent("onmousedown",p),document.documentElement.attachEvent("onkeydown",p),document.documentElement.attachEvent("onchange",p)))}return n.patches=[],n.object=e,n.unobserve=function(){l(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(o,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mouseup",p),window.removeEventListener("keyup",p),window.removeEventListener("mousedown",p),window.removeEventListener("keydown",p)):(document.documentElement.detachEvent("onmouseup",p),document.documentElement.detachEvent("onkeyup",p),document.documentElement.detachEvent("onmousedown",p),document.documentElement.detachEvent("onkeydown",p)))},o.observers.set(t,new h(t,n)),n},t.generate=l,t.compare=function(e,t){var n=[];return p(e,t,n,""),n}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=Array.prototype.slice,o=n(19),i=n(20),s=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=typeof e&&"object"!=typeof t?n.strict?e===t:e==t:function(e,t,n){var h,l;if(a(e)||a(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e))return!!i(t)&&(e=r.call(e),t=r.call(t),s(e,t,n));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(h=0;h<e.length;h++)if(e[h]!==t[h])return!1;return!0}try{var p=o(e),u=o(t)}catch(e){return!1}if(p.length!=u.length)return!1;for(p.sort(),u.sort(),h=p.length-1;h>=0;h--)if(p[h]!=u[h])return!1;for(h=p.length-1;h>=0;h--)if(l=p[h],!s(e[l],t[l],n))return!1;return typeof e==typeof t}(e,t,n))};function a(e){return null==e}function c(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}},function(e,t,n){var r={strict:!0},o=n(8),i=function(e,t){return o(e,t,r)},s=n(4);t.JsonPatchError=s.PatchError,t.deepClone=s._deepClone;var a={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=h(n,this.path);r&&(r=s._deepClone(r));var o=l(n,{op:"remove",path:this.from}).removed;return l(n,{op:"add",path:this.path,value:o}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=h(n,this.from);return l(n,{op:"add",path:this.path,value:s._deepClone(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:i(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},c={add:function(e,t,n){return s.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:a.move,copy:a.copy,test:a.test,_get:a._get};function h(e,t){if(""==t)return e;var n={op:"_get",path:t};return l(e,n),n.value}function l(e,n,r,o){if(void 0===r&&(r=!1),void 0===o&&(o=!0),r&&("function"==typeof r?r(n,0,e,n.path):u(n,0)),""===n.path){var l={newDocument:e};if("add"===n.op)return l.newDocument=n.value,l;if("replace"===n.op)return l.newDocument=n.value,l.removed=e,l;if("move"===n.op||"copy"===n.op)return l.newDocument=h(e,n.from),"move"===n.op&&(l.removed=e),l;if("test"===n.op){if(l.test=i(e,n.value),!1===l.test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",0,n,e);return l.newDocument=e,l}if("remove"===n.op)return l.removed=e,l.newDocument=null,l;if("_get"===n.op)return n.value=e,l;if(r)throw new t.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",0,n,e);return l}o||(e=s._deepClone(e));var p=(n.path||"").split("/"),d=e,f=1,v=p.length,m=void 0,w=void 0,y=void 0;for(y="function"==typeof r?r:u;;){if(w=p[f],r&&void 0===m&&(void 0===d[w]?m=p.slice(0,f).join("/"):f==v-1&&(m=n.path),void 0!==m&&y(n,0,e,m)),f++,Array.isArray(d)){if("-"===w)w=d.length;else{if(r&&!s.isInteger(w))throw new t.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",0,n.path,n);s.isInteger(w)&&(w=~~w)}if(f>=v){if(r&&"add"===n.op&&w>d.length)throw new t.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",0,n.path,n);if(!1===(l=c[n.op].call(n,d,w,e)).test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",0,n,e);return l}}else if(w&&-1!=w.indexOf("~")&&(w=s.unescapePathComponent(w)),f>=v){if(!1===(l=a[n.op].call(n,d,w,e)).test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",0,n,e);return l}d=d[w]}}function p(e,n,r,o){if(void 0===o&&(o=!0),r&&!Array.isArray(n))throw new t.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");o||(e=s._deepClone(e));for(var i=new Array(n.length),a=0,c=n.length;a<c;a++)i[a]=l(e,n[a],r),e=i[a].newDocument;return i.newDocument=e,i}function u(e,n,r,o){if("object"!=typeof e||null===e||Array.isArray(e))throw new t.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,e,r);if(!a[e.op])throw new t.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,e,r);if("string"!=typeof e.path)throw new t.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new t.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",n,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new t.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new t.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&s.hasUndefined(e.value))throw new t.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,e,r);if(r)if("add"==e.op){var i=e.path.split("/").length,c=o.split("/").length;if(i!==c+1&&i!==c)throw new t.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new t.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,e,r)}else if("move"===e.op||"copy"===e.op){var h=d([{op:"_get",path:e.from,value:void 0}],r);if(h&&"OPERATION_PATH_UNRESOLVABLE"===h.name)throw new t.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,e,r)}}function d(e,n,r){try{if(!Array.isArray(e))throw new t.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(n)p(s._deepClone(n),s._deepClone(e),r||!0);else{r=r||u;for(var o=0;o<e.length;o++)r(e[o],o,n,void 0)}}catch(e){if(e instanceof t.JsonPatchError)return e;throw e}}t.getValueByPointer=h,t.applyOperation=l,t.applyPatch=p,t.applyReducer=function(e,n){var r=l(e,n);if(!1===r.test)throw new t.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",0,n,e);return r.newDocument},t.validator=u,t.validate=d},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return f});var r=n(1),o=n.n(r),i=n(0),s=n(11),a=n(2),c=n.n(a),h=n(5),l=n.n(h);const p="Client",u="Server";function d(e){return e.replace(/^http/i,"ws")}class f{constructor(e,t,n,r,i,a,c,h,l){if(this.palindrom=e,"undefined"!=typeof window&&window.location?this.remoteUrl=new o.a(t,window.location.href):this.remoteUrl=new o.a(t),r&&(this.onReceive=r),i&&(this.onSend=i),a&&(this.onConnectionError=a),h&&(this.onStateChange=h),c&&(this.onSocketOpened=c),Object.defineProperty(this,"useWebSocket",{get:function(){return n},set:e=>(n=e,0==e?this._ws&&(this._ws.onclose=function(){this._ws=null},this._ws.close()):this.wsUrl||(this.wsUrl=d(this.remoteUrl.href)),n)}),l){const e=1e3*l;this.heartbeat=new s.a(()=>{this.send([])},this._handleConnectionError.bind(this),e,e)}else this.heartbeat=new s.b}async _establish(e=null){this.heartbeat.stop();const t=e?await this._fetch("PATCH",this.remoteUrl.href+"/reconnect","application/json",JSON.stringify(e)):await this._fetch("GET",this.remoteUrl.href,"application/json",null);return this.useWebSocket&&this.webSocketUpgrade(this.onSocketOpened),this.heartbeat.start(),t}_handleConnectionError(e){this.heartbeat.stop(),this.palindrom.reconnector.triggerReconnection(),this.onConnectionError(e)}_handleFatalError(e){this.heartbeat.stop(),this.palindrom.reconnector.stopReconnecting(),this.onConnectionError(e)}_notifyReceive(){this.heartbeat.notifyReceive(),this.onReceive(...arguments)}async send(e){this.heartbeat.notifySend();const t=JSON.stringify(e);if(this.useWebSocket&&this._ws&&1===this._ws.readyState)this._ws.send(t),this.onSend(t,this._ws.url,"WS");else{const e=this.remoteUrl.href,n="PATCH",r=await this._fetch(n,e,"application/json-patch+json",t);this._notifyReceive(r,e,n)}return this}onReceive(){}onSend(){}onStateChange(){}upgrade(e){}webSocketUpgrade(e){this.wsUrl=d(this.remoteUrl.href);const t=this.wsUrl;this.closeConnection();const n=c.a.w3cwebsocket||c.a;this._ws=new n(t),this._ws.onopen=(n=>{this.onStateChange(this._ws.readyState,t),e&&e(n)}),this._ws.onmessage=(e=>{try{var t=JSON.parse(e.data)}catch(t){return void this._handleFatalError(new i.a(e.data,u,this._ws.url,"WS"))}this._notifyReceive(t,this._ws.url,"WS")}),this._ws.onerror=(e=>{if(this.onStateChange(this._ws.readyState,t,e.data),!this.useWebSocket)return;const n=["WebSocket connection could not be made","readyState: "+this._ws.readyState].join("\n");this._handleFatalError(new i.a(n,p,t,"WS"))}),this._ws.onclose=(e=>{this.onStateChange(this._ws.readyState,t,null,e.code,e.reason);const n=["WebSocket connection closed unexpectedly.","reason: "+e.reason,"readyState: "+this._ws.readyState,"stateCode: "+e.code].join("\n");e.reason?this._handleFatalError(new i.a(n,u,t,"WS")):e.wasClean||this._handleConnectionError(new i.a(n,u,t,"WS"))})}closeConnection(){this._ws&&(this._ws.onclose=(()=>{}),this._ws.close(),this._ws=null)}async getPatchUsingHTTP(e){const t=await this._fetch("GET",e,"application/json-patch+json",null,!0);return this._notifyReceive(t,e,"GET"),t}_setRemoteUrl(e){if(this.remoteUrlSet&&this.remoteUrl&&this.remoteUrl!=e){const t=["Session lost.","Server replied with a different session ID than the already set one.","Possibly a server restart happened while you were working.","Please reload the page.","Previous session ID: "+this.remoteUrl,"New session ID: "+e].join("\n");throw new i.b(t)}this.remoteUrlSet=!0,this.remoteUrl=new o.a(e,this.remoteUrl.href)}_handleLocationHeader(e){const t=e.headers.get("x-location")||e.headers.get("location");t&&this._setRemoteUrl(t)}async _handleFailureResponse(e,t,n){var r=`An unknown network error has occurred. Raw message: ${n.message}`;console.error(n);const o=[r,"statusCode: -1","reason: Maybe you lost connection with the server","url: "+e,"HTTP method: "+t].join("\n");this._handleFatalError(new i.a(o,p,e,t))}async _fetch(t,n,r,o,i){const s={headers:{},method:t,credentials:"include"},a=s.headers;o&&(a["Content-Type"]="application/json-patch+json",s.body=o),r&&(a.Accept=r),this.remoteUrl&&i&&(a["X-Referer"]=this.remoteUrl.pathname),this.onSend(o,n,t);let c=void 0!==e&&e.fetch||l.a;const h=await c(n,s);return h.json().then(e=>{if(h.status<500)return this._handleLocationHeader(h),e;throw new Error(`HTTP ${h.status} response: response body is ${JSON.stringify(e)}`)}).catch(e=>{throw this._handleFailureResponse(n,t,e),e})}}}).call(this,n(7))},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var r=n(0);const o="Client";function i(e,t,n,i){let s,a;this.start=function(){s||(s=setTimeout(()=>{this.notifySend(),e()},n))},this.notifySend=function(){clearTimeout(s),s=null,a||(a=setTimeout(()=>{a=null,t(new r.a("Timeout has passed and response hasn't arrived",o,this.remoteUrl,"Unknown"))},i))},this.notifyReceive=function(){clearTimeout(a),a=null,this.start()},this.stop=(()=>{clearTimeout(s),s=null,clearTimeout(a),a=null})}function s(){this.start=this.stop=this.notifySend=this.notifyReceive=(()=>{})}},function(e,t,n){"use strict";
/*!
 * https://github.com/Palindrom/JSONPatcherProxy
 * (c) 2017 Starcounter 
 * MIT license
 */const r=function(){function e(e){return-1==e.indexOf("/")&&-1==e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function t(e,t){const n=[];let r=e.parenthoodMap.get(t);for(;r&&r.path;)n.unshift(r.path),r=e.parenthoodMap.get(r.parent);if(n.length){return"/"+n.join("/")}return""}function n(e,t){this.isProxifyingTreeNow=!1,this.isObserving=!1,this.proxifiedObjectsMap=new Map,this.parenthoodMap=new Map,"boolean"!=typeof t&&(t=!0),this.showDetachedWarning=t,this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback,this.resume=function(){this.defaultCallback=(e=>{this.isRecording&&this.patches.push(e),this.userCallback&&this.userCallback(e)}),this.isObserving=!0}.bind(this),this.pause=function(){this.defaultCallback=(()=>{}),this.isObserving=!1}.bind(this)}return n.deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},n.escapePathComponent=e,n.prototype.generateProxyAtPath=function(n,r,o){if(!r)return r;const i={set:(n,r,o,i)=>(function(n,r,o,i){const s=t(n,r)+"/"+e(o);if(n.proxifiedObjectsMap.has(i)){const e=n.proxifiedObjectsMap.get(i);n.parenthoodMap.set(e.originalObject,{parent:r,path:o})}const a=n.proxifiedObjectsMap.get(i);a&&!n.isProxifyingTreeNow&&(a.inherited=!0),i&&"object"==typeof i&&!n.proxifiedObjectsMap.has(i)&&(n.parenthoodMap.set(i,{parent:r,path:o}),i=n._proxifyObjectTreeRecursively(r,i,o));const c={op:"remove",path:s};if(void 0===i){if(!Array.isArray(r)&&!r.hasOwnProperty(o))return Reflect.set(r,o,i);{Array.isArray(r)&&(c.op="replace",c.value=null);const e=n.proxifiedObjectsMap.get(r[o]);e&&(n.parenthoodMap.delete(r[o]),n.disableTrapsForProxy(e),n.proxifiedObjectsMap.delete(e))}}else{if(Array.isArray(r)&&!Number.isInteger(+o.toString()))return"length"!=o&&console.warn("JSONPatcherProxy noticed a non-integer prop was set for an array. This will not emit a patch"),Reflect.set(r,o,i);c.op="add",r.hasOwnProperty(o)&&(void 0!==r[o]||Array.isArray(r))&&(c.op="replace"),c.value=i}const h=Reflect.set(r,o,i);return n.defaultCallback(c),h})(this,n,r,o),deleteProperty:(n,r)=>(function(n,r,o){if(void 0!==r[o]){const i=t(n,r)+"/"+e(o),s=n.proxifiedObjectsMap.get(r[o]);s&&(s.inherited?s.inherited=!1:(n.parenthoodMap.delete(s.originalObject),n.disableTrapsForProxy(s),n.proxifiedObjectsMap.delete(r[o])));const a=Reflect.deleteProperty(r,o);return n.defaultCallback({op:"remove",path:i}),a}})(this,n,r)},s=Proxy.revocable(r,i);return s.trapsInstance=i,s.originalObject=r,this.parenthoodMap.set(r,{parent:n,path:o}),this.proxifiedObjectsMap.set(s.proxy,s),s.proxy},n.prototype._proxifyObjectTreeRecursively=function(t,n,r){for(let t in n)n.hasOwnProperty(t)&&n[t]instanceof Object&&(n[t]=this._proxifyObjectTreeRecursively(n,n[t],e(t)));return this.generateProxyAtPath(t,n,r)},n.prototype.proxifyObjectTree=function(e){this.pause(),this.isProxifyingTreeNow=!0;const t=this._proxifyObjectTreeRecursively(void 0,e,"");return this.isProxifyingTreeNow=!1,this.resume(),t},n.prototype.disableTrapsForProxy=function(e){if(this.showDetachedWarning){const t="You're accessing an object that is detached from the observedObject tree, see https://github.com/Palindrom/JSONPatcherProxy#detached-objects";e.trapsInstance.set=((e,n,r)=>(console.warn(t),Reflect.set(e,n,r))),e.trapsInstance.set=((e,n,r)=>(console.warn(t),Reflect.set(e,n,r))),e.trapsInstance.deleteProperty=((e,t)=>Reflect.deleteProperty(e,t))}else delete e.trapsInstance.set,delete e.trapsInstance.get,delete e.trapsInstance.deleteProperty},n.prototype.observe=function(e,t){if(!e&&!t)throw new Error("You need to either record changes or pass a callback");return this.isRecording=e,this.userCallback=t,e&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(this.originalObject),this.cachedProxy},n.prototype.generate=function(){if(!this.isRecording)throw new Error("You should set record to true to get patches later");return this.patches.splice(0,this.patches.length)},n.prototype.revoke=function(){this.proxifiedObjectsMap.forEach(e=>{e.revoke()})},n.prototype.disableTraps=function(){this.proxifiedObjectsMap.forEach(this.disableTrapsForProxy,this)},n}();e.exports=r,e.exports.default=r},function(e,t,n){
/*!
 * https://github.com/Palindrom/JSONPatchOT
 * JSON-Patch-OT version: 1.0.1
 * (c) 2017 Tomek Wytrebowicz
 * MIT license
 */
var r=function(){var e=e||{};e.transform=function(e,n){var r=[];r=r.concat.apply(r,n);var o=JSON.parse(JSON.stringify(e));return r.reduce(t,o)},e.transformAgainstSingleOp=function(e,t){};var t=function(e,t){if(void 0===t.value&&("add"===t.op||"replace"===t.op||"test"===t.op))throw new Error("'value' MUST be defined");if(void 0===t.from&&("copy"===t.op||"move"===t.op))throw new Error("'from' MUST be defined");if(n[t.op])if("function"==typeof n[t.op])n[t.op](t,e);else for(var r=e.length,o=0;o<r;){var i=e[o];o++,n[t.op][i.op]&&n[t.op][i.op](t,i)}return e},n={remove:function(e,t){for(var n,i=t.length,s=0;n=t[s];)("add"!==n.op&&"test"!==n.op||e.path!==n.path)&&(n.from&&(n.from===e.path||0===n.from.indexOf(e.path+"/"))||e.path===n.path||0===n.path.indexOf(e.path+"/"))&&(t.splice(s,1),i--,s--),s++;var a=e.path.lastIndexOf("/");if(a>-1){var c=e.path.substr(a+1),h=e.path.substr(0,a+1);if(o(c))for(i=t.length,s=0;s<i;)n=t[s],s++,0===n.path.indexOf(h)&&(n.path=r(n.path,h,c)),n.from&&0===n.from.indexOf(h)&&(n.from=r(n.from,h,c))}},replace:function(e,t){for(var n,r=0;n=t[r];)(n.from&&(n.from===e.path||0===n.from.indexOf(e.path+"/"))||0===n.path.indexOf(e.path+"/"))&&(t.splice(r,1),r--),r++}};function r(e,t,n){var r=e.substr(t.length),i=r.indexOf("/");i>-1||(i=r.length);var s=r.substr(0,i),a=r.substr(i);return o(s)&&s>n?t+(s-1)+a:e}function o(e){var t=~~Number(e);return String(t)===e&&t>=0}return e}();e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e,t,n){if(void 0===r)var r=n(3).JSONPatchQueue;var o=function(e,t,n,o,i){r.call(this,e,n,o,i),this.transform=t,this.pending=[]};(o.prototype=Object.create(r.prototype)).constructor=o,o.prototype.ackLocalVersion=0,o.prototype.send=function(e){var t=e.slice(0);t.unshift({op:"test",path:this.remotePath,value:this.remoteVersion});var n=r.prototype.send.call(this,t);return this.pending.push(n),n},o.prototype.receive=function(e,t){var n=t||this.apply,o=this;return r.prototype.receive.call(this,e,function(e,t){var r=t.slice(0),i=r.shift().value,s=i-o.ackLocalVersion;return o.ackLocalVersion=i,o.pending.splice(0,s),o.pending.length&&(r=o.transform(r,o.pending)),o.obj=n(o.obj,r)})},o.prototype.reset=function(e){return this.ackLocalVersion=r.getPropertyByJsonPointer(e,this.localPath),this.pending=[],this.obj=r.prototype.reset.call(this,e)},e.exports=o,e.exports.default=o,e.exports.__esModule=!0},function(e,t,n){"use strict";n.r(t);var r=n(10),o=n(6),i=n(12),s=n.n(i),a=n(3),c=n(13),h=n.n(c),l=n(14),p=n.n(l),u=n(0);function d(e,t,n){let r,o,i,s;const a=1e3;function c(){r=a,o=0,i=!1,clearTimeout(s),s=null}const h=()=>{0==o?(t(0),i=!1,r*=2,e()):(t(o),o-=1e3,setTimeout(h,1e3))};this.triggerReconnection=(()=>{i||(o=r,i=!0,h())}),this.reconnectNow=(()=>{o=0,r=a}),this.stopReconnecting=(()=>{c(),n()}),c()}class f{constructor(e,t){this.obj=e,this.apply=t}send(e){return e}receive(e){return this.obj=this.apply(this.obj,e)}reset(e){const t=[{op:"replace",path:"",value:e}];return this.obj=this.apply(this.obj,t)}}
/*! Palindrom
 * https://github.com/Palindrom/Palindrom
 * (c) 2017 Joachim Wester
 * MIT license
 */const v="6.1.0";if(void 0===m)if("undefined"!=typeof window)var m=window;else m={};class w{static get version(){return v}constructor(e){if(this.version=v,"object"!=typeof e)throw new TypeError("Palindrom constructor requires an object argument.");if(!e.remoteUrl)throw new TypeError("remoteUrl is required");function t(){}e.callback&&console.warn("options.callback is deprecated. Please use `onStateReset` instead"),this.debug=null==e.debug||e.debug,this.isObserving=!1,this.onLocalChange=e.onLocalChange||t,this.onRemoteChange=e.onRemoteChange||t,this.onStateReset=e.onStateReset||e.callback||t,this.filterLocalChange=e.filterLocalChange||(e=>e),this.onPatchReceived=e.onPatchReceived||t,this.onPatchSent=e.onPatchSent||t,this.onSocketStateChanged=e.onSocketStateChanged||t,this.onConnectionError=e.onConnectionError||t,this.retransmissionThreshold=e.retransmissionThreshold||3,this.onReconnectionCountdown=e.onReconnectionCountdown||t,this.onReconnectionEnd=e.onReconnectionEnd||t,this.onSocketOpened=e.onSocketOpened||t,this.onIncomingPatchValidationError=e.onIncomingPatchValidationError||t,this.onOutgoingPatchValidationError=e.onOutgoingPatchValidationError||t,this.onError=e.onError||t,this.reconnector=new d(()=>this._connectToRemote(this.queue.pending),this.onReconnectionCountdown,this.onReconnectionEnd),this.network=new r.a(this,e.remoteUrl,e.useWebSocket||!1,this.handleRemoteChange.bind(this),this.onPatchSent.bind(this),this.onConnectionError.bind(this),this.onSocketOpened.bind(this),this.onSocketStateChanged.bind(this),e.pingIntervalS),this.OTPatchIndexOffset=0,e.localVersionPath?e.remoteVersionPath?(this.OTPatchIndexOffset=2,e.ot?this.queue=new p.a(this.obj,h.a.transform,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity):this.queue=new a.JSONPatchQueue(this.obj,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity)):(this.OTPatchIndexOffset=1,this.queue=new a.JSONPatchQueueSynchronous(this.obj,e.localVersionPath,this.validateAndApplySequence.bind(this),e.purity)):this.queue=new f(this.obj,this.validateAndApplySequence.bind(this)),this._connectToRemote()}async _connectToRemote(e=null){const t=await this.network._establish(e);this.reconnector.stopReconnecting(),this.debug&&(this.remoteObj=JSON.parse(JSON.stringify(t))),this.queue.reset(t)}get useWebSocket(){return this.network.useWebSocket}set useWebSocket(e){this.network.useWebSocket=e}_sendPatch(e){this.unobserve(),this.network.send(e),this.observe()}prepareProxifiedObject(e){e||(e={}),this.jsonPatcherProxy=new s.a(e);const t=this.jsonPatcherProxy.observe(!1,e=>{const t=this.filterLocalChange(e);t&&this.handleLocalChange(t)});Object.defineProperty(this,"obj",{get:()=>t,set(){throw new Error("palindrom.obj is readonly")},configurable:!0}),this.isObserving=!0}observe(){this.jsonPatcherProxy&&this.jsonPatcherProxy.resume(),this.isObserving=!0}unobserve(){this.jsonPatcherProxy&&this.jsonPatcherProxy.pause(),this.isObserving=!1}handleLocalChange(e){e.value&&y(e.value,this.onOutgoingPatchValidationError,e.path);const t=[e];this.debug&&this.validateSequence(this.remoteObj,t),this._sendPatch(this.queue.send(t)),this.onLocalChange(t)}validateAndApplySequence(e,t){try{this.unobserve();const n=Object(o.applyPatch)(e,t,this.debug);if(this.observe(),n.newDocument!==e){this.prepareProxifiedObject(n.newDocument),this.queue.obj=this.obj,y(this.obj,this.onIncomingPatchValidationError);try{this.onStateReset(this.obj)}catch(e){this.onError(new u.b(`Error inside onStateReset callback: ${e.message}`)),console.error(e)}}this.onRemoteChange(t,n)}catch(e){if(this.debug)return void this.onIncomingPatchValidationError(e);throw e}return this.obj}validateSequence(e,t){const n=Object(o.validate)(t,e);n&&this.onOutgoingPatchValidationError(n)}reconnectNow(){this.reconnector.reconnectNow()}handleRemoteChange(e,t,n){this.onPatchReceived(e,t,n);const r=e||[];!function(e,t,n){for(let r=n,o=e.length;r<o;r++)y(e[r].value,t,e[r].path)}(r,this.onIncomingPatchValidationError,this.OTPatchIndexOffset),0!==r.length&&this.isObserving&&(this.queue.receive(r),this.queue.pending&&this.queue.pending.length&&this.queue.pending.length>this.retransmissionThreshold&&this.queue.pending.forEach(this._sendPatch,this),this.debug&&(this.remoteObj=JSON.parse(JSON.stringify(this.obj))))}}function y(e,t,n=""){const r=typeof e;if("object"==r)for(const r in e)e.hasOwnProperty(r)&&y(e[r],t,n+"/"+r);else"number"===r&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&t(new RangeError(`A number that is either bigger than Number.MAX_INTEGER_VALUE or smaller than Number.MIN_INTEGER_VALUE has been encountered in a patch, value is: ${e}, variable path is: ${n}`))}n.d(t,"default",function(){return P});
/*! Palindrom
 * https://github.com/Palindrom/Palindrom
 * (c) 2017 Joachim Wester
 * MIT license
 */
class b extends Error{}async function g(e){return new Promise(t=>{setTimeout(t,e)})}class P extends w{constructor(e){if("object"!=typeof e)throw new Error("PalindromDOM constructor requires an object argument.");if(!e.remoteUrl)throw new Error("remoteUrl is required");const t=e.onStateReset||e.callback;e.callback&&console.warn("Palindrom: options.callback is deprecated. Please use `onStateReset` instead"),e.onStateReset=function(e){this.listen(),t&&t.call(this,e)},super(e),this.element=e.listenTo||document,this.clickHandler=this.clickHandler.bind(this),this.historyHandler=this.historyHandler.bind(this),this.morphUrlEventHandler=this.morphUrlEventHandler.bind(this),this._scrollWatcher=this._scrollWatcher.bind(this),this.element.addEventListener("palindrom-redirect-pushstate",this.morphUrlEventHandler),"scrollRestoration"in history&&(history.scrollRestoration="manual")}listen(){this.listening=!0,this.element.addEventListener("click",this.clickHandler),window.addEventListener("popstate",this.historyHandler),this.element.addEventListener("palindrom-morph-url",this.morphUrlEventHandler),this.element.addEventListener("palindrom-redirect-pushstate",this.morphUrlEventHandler),this._watchingScroll()}_watchingScroll(){window.addEventListener("scroll",this._scrollWatcher)}_unwatchingScroll(){window.removeEventListener("scroll",this._scrollWatcher)}_scrollWatcher(){this._attemptingScroll||(clearTimeout(this._scrollDebounceTimeout),this._scrollDebounceTimeout=setTimeout(()=>{history.replaceState([window.scrollX,window.scrollY],null)},20))}unlisten(){this.listening=!1,this.element.removeEventListener("click",this.clickHandler),window.removeEventListener("popstate",this.historyHandler),this.element.removeEventListener("palindrom-redirect-pushstate",this.morphUrlEventHandler),this.element.removeEventListener("palindrom-morph-url",this.morphUrlEventHandler),this._unwatchingScroll()}async getPatchUsingHTTP(e){const t=new CustomEvent("palindrom-before-redirect",{detail:{href:e},cancelable:!0,bubbles:!0});if(this.element.dispatchEvent(t),t.defaultPrevented)throw new b("`getPatchUsingHTTP` was aborted by cancelling `palindrom-before-redirect` event.");const n=await this.network.getPatchUsingHTTP(e);const r=new CustomEvent("palindrom-after-redirect",{detail:{href:e,data:n},bubbles:!0});return this.element.dispatchEvent(r),n}async morphUrl(e){const t=window.scrollX,n=window.scrollY;try{if(await this.getPatchUsingHTTP(e))return history.replaceState([t,n],null,window.location.href),history.pushState([0,0],null,e),scrollTo(0,0),!0}catch(e){if(e instanceof b)return!1;throw new Error(`HTTP request failed, error message: ${e.message}`)}}morphUrlEventHandler(e){return this.morphUrl(e.detail.url)}clickHandler(e){if(e.ctrlKey||e.metaKey||2==e.which)return;e.detail&&e.detail.target&&(e=e.detail);let t=e.target;if("A"!==t.nodeName){let n=e.composedPath&&e.composedPath();n||(n=e.path);for(let e=0;e<n.length;e++)if("A"==n[e].nodeName){t=n[e];break}}const n=t.target||t.getAttribute("target");if(!(t.hasAttribute("download")||n&&"_self"!==n)){const n=t.href||t.getAttribute("href");n&&P.isApplicationLink(n)?(e.preventDefault(),e.stopPropagation(),this.morphUrl(n)):"submit"===t.type&&e.preventDefault()}}async historyHandler(e){await this.getPatchUsingHTTP(location.href);const[t,n]=e.state||[0,0];let r=!1;this._attemptingScroll=!1;const o=()=>r=!this._attemptingScroll;window.addEventListener("scroll",o),await g(30);for(let e=0;e<30&&!r;e++){this._attemptingScroll=!0;const e=(i=t,s=n,scrollTo(i,s),window.scrollX===i&&window.scrollY===s);if(this._attemptingScroll=!1,e)break;await g(30)}var i,s;window.removeEventListener("scroll",o)}static isApplicationLink(e){if("string"==typeof e){const t=document.createElement("A");t.href=e,""==t.host&&(t.href=t.href),e=t}return e.protocol==window.location.protocol&&e.host==window.location.host}}},,,,function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports="function"==typeof Object.keys?Object.keys:n).shim=n},function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==typeof e&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=n?r:o).supported=r,t.unsupported=o},function(e,t,n){var r=function(e,t,n,r){this.obj=e,this.waiting=[],this.localPath=t[0],this.remotePath=t[1],this.apply=n,this.purist=r};r.prototype.localVersion=0,r.prototype.remoteVersion=0,r.prototype.receive=function(e,t){var n=t||this.apply,r=e.slice(0);if(this.purist)r.shift();var o=r.shift().value;if(o<=this.remoteVersion)throw new Error("Given version was already applied.");if(o==this.remoteVersion+1)for(;r;)this.remoteVersion++,this.obj=n(this.obj,r),r=this.waiting.shift();else this.waiting[o-this.remoteVersion-2]=r},r.prototype.send=function(e){this.localVersion++;var t=e.slice(0);return this.purist?t.unshift({op:"test",path:this.localPath,value:this.localVersion-1},{op:"replace",path:this.localPath,value:this.localVersion}):t.unshift({op:"replace",path:this.localPath,value:this.localVersion}),t},r.getPropertyByJsonPointer=function(e,t){var n=t.split("/");""===n[0]&&n.shift();for(var r=e;n.length;){var o=n.shift().replace("~1","/").replace("~0","~");n.length&&(r=r[o])}return r[o]},r.prototype.reset=function(e){this.remoteVersion=r.getPropertyByJsonPointer(e,this.remotePath),this.waiting=[];var t=[{op:"replace",path:"",value:e}];return this.obj=this.apply(this.obj,t)},e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e,t,n){var r=function(e,t,n,r){this.obj=e,this.waiting=[],this.versionPath=t,this.apply=n,this.purist=r};r.prototype.version=0,r.prototype.receive=function(e,t){var n=t||this.apply,r=e.slice(0);if(this.purist)r.shift();var o=r.shift().value;if(o<=this.version)throw new Error("Given version was already applied.");if(o==this.version+1)for(;r;)this.version++,this.obj=n(this.obj,r),r=this.waiting.shift();else this.waiting[o-this.version-2]=r},r.prototype.send=function(e){this.version++;var t=e.slice(0);return t.unshift({op:"replace",path:this.versionPath,value:this.version}),this.purist&&t.unshift({op:"test",path:this.versionPath,value:this.version-1}),t},r.getPropertyByJsonPointer=function(e,t){var n=t.split("/");""===n[0]&&n.shift();for(var r=e;n.length;){var o=n.shift().replace("~1","/").replace("~0","~");n.length&&(r=r[o])}return r[o]},r.prototype.reset=function(e){this.version=r.getPropertyByJsonPointer(e,this.versionPath),this.waiting=[];var t=[{op:"replace",path:"",value:e}];return this.obj=this.apply(this.obj,t)},e.exports=r,e.exports.default=r,e.exports.__esModule=!0}]).default;