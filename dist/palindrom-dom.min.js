/*! Palindrom, version: 3.1.0 */
var PalindromDOM=function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var o=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(o,'a',o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=40)}([function(e,t,o){'use strict';function r(e){return'[object Array]'===d.call(e)}function n(e){return null!==e&&'object'==typeof e}function a(e){return'[object Function]'===d.call(e)}function s(e,t){if(null!==e&&'undefined'!=typeof e)if('object'==typeof e||r(e)||(e=[e]),r(e))for(var o=0,n=e.length;o<n;o++)t.call(null,e[o],o,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}function i(){function e(e,o){t[o]='object'==typeof t[o]&&'object'==typeof e?i(t[o],e):e}for(var t={},o=0,r=arguments.length;o<r;o++)s(arguments[o],e);return t}var p=o(8),d=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:function(e){return'[object ArrayBuffer]'===d.call(e)},isFormData:function(e){return'undefined'!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){var t;return t='undefined'!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t},isString:function(e){return'string'==typeof e},isNumber:function(e){return'number'==typeof e},isObject:n,isUndefined:function(e){return'undefined'==typeof e},isDate:function(e){return'[object Date]'===d.call(e)},isFile:function(e){return'[object File]'===d.call(e)},isBlob:function(e){return'[object Blob]'===d.call(e)},isFunction:a,isStream:function(e){return n(e)&&a(e.pipe)},isURLSearchParams:function(e){return'undefined'!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return'undefined'!=typeof window&&'undefined'!=typeof document&&'function'==typeof document.createElement},forEach:s,merge:i,extend:function(e,t,o){return s(t,function(t,r){e[r]=o&&'function'==typeof t?p(t,o):t}),e},trim:function(e){return e.replace(/^\s*/,'').replace(/\s*$/,'')}}},function(e,t,o){'use strict';(function(t){function r(e,t){!n.isUndefined(e)&&n.isUndefined(e['Content-Type'])&&(e['Content-Type']=t)}var n=o(0),a=o(27),s=/^\)\]\}',?\n/,i={"Content-Type":'application/x-www-form-urlencoded'},p={adapter:function(){var e;return'undefined'==typeof XMLHttpRequest?'undefined'!=typeof t&&(e=o(4)):e=o(4),e}(),transformRequest:[function(e,t){return a(t,'Content-Type'),n.isFormData(e)||n.isArrayBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(r(t,'application/x-www-form-urlencoded;charset=utf-8'),e.toString()):n.isObject(e)?(r(t,'application/json;charset=utf-8'),JSON.stringify(e)):e}],transformResponse:[function(e){if('string'==typeof e){e=e.replace(s,'');try{e=JSON.parse(e)}catch(t){}}return e}],timeout:0,xsrfCookieName:'XSRF-TOKEN',xsrfHeaderName:'X-XSRF-TOKEN',maxContentLength:-1,validateStatus:function(e){return 200<=e&&300>e}};p.headers={common:{Accept:'application/json, text/plain, */*'}},n.forEach(['delete','get','head'],function(e){p.headers[e]={}}),n.forEach(['post','put','patch'],function(e){p.headers[e]=n.merge(i)}),e.exports=p}).call(t,o(38))},function(e,t){function o(e,t){return p.call(e,t)}function r(e){if(Array.isArray(e)){for(var t=Array(e.length),r=0;r<t.length;r++)t[r]=''+r;return t}if(Object.keys)return Object.keys(e);var t=[];for(var n in e)o(e,n)&&t.push(n);return t}function n(e){return-1===e.indexOf('/')&&-1===e.indexOf('~')?e:e.replace(/~/g,'~0').replace(/\//g,'~1')}function a(e,t){var r;for(var s in e)if(o(e,s)){if(e[s]===t)return n(s)+'/';if('object'==typeof e[s]&&(r=a(e[s],t),''!=r))return n(s)+'/'+r}return''}function s(e){if(e===void 0)return!0;if(e)if(Array.isArray(e)){for(var t=0,o=e.length;t<o;t++)if(s(e[t]))return!0;}else if('object'==typeof e)for(var n=r(e),a=n.length,t=0;t<a;t++)if(s(e[n[t]]))return!0;return!1}var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},p=Object.prototype.hasOwnProperty;t.hasOwnProperty=o,t._objectKeys=r;t._deepClone=function(e){switch(typeof e){case'object':return JSON.parse(JSON.stringify(e));case'undefined':return null;default:return e;}},t.isInteger=function(e){for(var t,o=0,r=e.length;o<r;){if(t=e.charCodeAt(o),48<=t&&57>=t){o++;continue}return!1}return!0},t.escapePathComponent=n,t.unescapePathComponent=function(e){return e.replace(/~1/g,'/').replace(/~0/g,'~')},t._getPathRecursive=a,t.getPath=function(e,t){if(e===t)return'/';var o=a(e,t);if(''===o)throw new Error('Object not found in root');return'/'+o},t.hasUndefined=s;var d=function(e){function t(t,o,r,n,a){e.call(this,t),this.message=t,this.name=o,this.index=r,this.operation=n,this.tree=a}return i(t,e),t}(Error);t.PatchError=d},function(e,t,o){var r=o(36),n=o(35);e.exports={JSONPatchQueue:r,JSONPatchQueueSynchronous:n,__esModule:!0}},function(e,t,o){'use strict';var r=o(0),n=o(19),a=o(22),s=o(28),i=o(26),p=o(7),d='undefined'!=typeof window&&window.btoa&&window.btoa.bind(window)||o(21);e.exports=function(e){return new Promise(function(t,l){var c=e.data,h=e.headers;r.isFormData(c)&&delete h['Content-Type'];var u=new XMLHttpRequest,f='onreadystatechange',m=!1;if('undefined'==typeof window||!window.XDomainRequest||'withCredentials'in u||i(e.url)||(u=new window.XDomainRequest,f='onload',m=!0,u.onprogress=function(){},u.ontimeout=function(){}),e.auth){var y=e.auth.username||'',g=e.auth.password||'';h.Authorization='Basic '+d(y+':'+g)}if(u.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,u[f]=function(){if(u&&(4===u.readyState||m)&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf('file:'))){var o='getAllResponseHeaders'in u?s(u.getAllResponseHeaders()):null,r=e.responseType&&'text'!==e.responseType?u.response:u.responseText,a={data:r,status:1223===u.status?204:u.status,statusText:1223===u.status?'No Content':u.statusText,headers:o,config:e,request:u};n(t,l,a),u=null}},u.onerror=function(){l(p('Network Error',e)),u=null},u.ontimeout=function(){l(p('timeout of '+e.timeout+'ms exceeded',e,'ECONNABORTED')),u=null},r.isStandardBrowserEnv()){var b=o(24),v=(e.withCredentials||i(e.url))&&e.xsrfCookieName?b.read(e.xsrfCookieName):void 0;v&&(h[e.xsrfHeaderName]=v)}if('setRequestHeader'in u&&r.forEach(h,function(e,t){'undefined'==typeof c&&'content-type'===t.toLowerCase()?delete h[t]:u.setRequestHeader(t,e)}),e.withCredentials&&(u.withCredentials=!0),e.responseType)try{u.responseType=e.responseType}catch(t){if('json'!==u.responseType)throw t}'function'==typeof e.onDownloadProgress&&u.addEventListener('progress',e.onDownloadProgress),'function'==typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener('progress',e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){u&&(u.abort(),l(e),u=null)}),void 0===c&&(c=null),u.send(c)})}},function(e){'use strict';function t(e){this.message=e}t.prototype.toString=function(){return'Cancel'+(this.message?': '+this.message:'')},t.prototype.__CANCEL__=!0,e.exports=t},function(e){'use strict';e.exports=function(e){return!!(e&&e.__CANCEL__)}},function(e,t,o){'use strict';var r=o(18);e.exports=function(e,t,o,n){var a=new Error(e);return r(a,t,o,n)}},function(e){'use strict';e.exports=function(e,t){return function(){for(var o=Array(arguments.length),r=0;r<o.length;r++)o[r]=arguments[r];return e.apply(t,o)}}},function(e,t,o){function r(e){return null===e||e===void 0}function n(e){return e&&'object'==typeof e&&'number'==typeof e.length&&('function'!=typeof e.copy||'function'!=typeof e.slice?!1:0<e.length&&'number'!=typeof e[0]?!1:!0)}function a(e,t,o){var l,c;if(r(e)||r(t))return!1;if(e.prototype!==t.prototype)return!1;if(p(e))return!!p(t)&&(e=s.call(e),t=s.call(t),d(e,t,o));if(n(e)){if(!n(t))return!1;if(e.length!==t.length)return!1;for(l=0;l<e.length;l++)if(e[l]!==t[l])return!1;return!0}try{var h=i(e),u=i(t)}catch(t){return!1}if(h.length!=u.length)return!1;for(h.sort(),u.sort(),l=h.length-1;0<=l;l--)if(h[l]!=u[l])return!1;for(l=h.length-1;0<=l;l--)if(c=h[l],!d(e[c],t[c],o))return!1;return typeof e==typeof t}var s=Array.prototype.slice,i=o(31),p=o(30),d=e.exports=function(e,t,o){return o||(o={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e&&t&&('object'==typeof e||'object'==typeof t)?a(e,t,o):o.strict?e===t:e==t)}},function(e,o,t){function r(e,t){if(''==t)return e;var o={op:'_get',path:t};return n(e,o),o.value}function n(e,n,a,i){if(void 0===a&&(a=!1),void 0===i&&(i=!0),a&&('function'==typeof a?a(n,0,e,n.path):s(n,0)),''===n.path){var p={newDocument:e};if('add'===n.op)return p.newDocument=n.value,p;if('replace'===n.op)return p.newDocument=n.value,p.removed=e,p;if('move'===n.op||'copy'===n.op)return p.newDocument=r(e,n.from),'move'===n.op&&(p.removed=e),p;if('test'===n.op){if(p.test=l(e,n.value),!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,n,e);return p.newDocument=e,p}if('remove'===n.op)return p.removed=e,p.newDocument=null,p;if('_get'===n.op)return n.value=e,p;if(a)throw new o.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',0,n,e);else return p}else{i||(e=c._deepClone(e));var d,f,m,y=n.path||'',g=y.split('/'),b=e,v=1,t=g.length;for(m='function'==typeof a?a:s;;){if(f=g[v],a&&void 0==d&&(void 0===b[f]?d=g.slice(0,v).join('/'):v==t-1&&(d=n.path),void 0!==d&&m(n,0,e,d)),v++,Array.isArray(b)){if('-'===f)f=b.length;else if(a&&!c.isInteger(f))throw new o.JsonPatchError('Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index','OPERATION_PATH_ILLEGAL_ARRAY_INDEX',0,n.path,n);else c.isInteger(f)&&(f=~~f);if(v>=t){if(a&&'add'===n.op&&f>b.length)throw new o.JsonPatchError('The specified index MUST NOT be greater than the number of elements in the array','OPERATION_VALUE_OUT_OF_BOUNDS',0,n.path,n);var p=u[n.op].call(n,b,f,e);if(!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,n,e);return p}}else if(f&&-1!=f.indexOf('~')&&(f=c.unescapePathComponent(f)),v>=t){var p=h[n.op].call(n,b,f,e);if(!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,n,e);return p}b=b[f]}}}function a(e,t,r,a){if(void 0===a&&(a=!0),r&&!Array.isArray(t))throw new o.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');a||(e=c._deepClone(e));for(var s=Array(t.length),p=0,i=t.length;p<i;p++)s[p]=n(e,t[p],r),e=s[p].newDocument;return s.newDocument=e,s}function s(e,t,r,n){if('object'!=typeof e||null===e||Array.isArray(e))throw new o.JsonPatchError('Operation is not an object','OPERATION_NOT_AN_OBJECT',t,e,r);else if(!h[e.op])throw new o.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',t,e,r);else if('string'!=typeof e.path)throw new o.JsonPatchError('Operation `path` property is not a string','OPERATION_PATH_INVALID',t,e,r);else if(0!==e.path.indexOf('/')&&0<e.path.length)throw new o.JsonPatchError('Operation `path` property must start with "/"','OPERATION_PATH_INVALID',t,e,r);else if(('move'===e.op||'copy'===e.op)&&'string'!=typeof e.from)throw new o.JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)','OPERATION_FROM_REQUIRED',t,e,r);else if(('add'===e.op||'replace'===e.op||'test'===e.op)&&e.value===void 0)throw new o.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_REQUIRED',t,e,r);else if(('add'===e.op||'replace'===e.op||'test'===e.op)&&c.hasUndefined(e.value))throw new o.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED',t,e,r);else if(r)if('add'==e.op){var a=e.path.split('/').length,s=n.split('/').length;if(a!==s+1&&a!==s)throw new o.JsonPatchError('Cannot perform an `add` operation at the desired path','OPERATION_PATH_CANNOT_ADD',t,e,r)}else if('replace'===e.op||'remove'===e.op||'_get'===e.op){if(e.path!==n)throw new o.JsonPatchError('Cannot perform the operation at a path that does not exist','OPERATION_PATH_UNRESOLVABLE',t,e,r);}else if('move'===e.op||'copy'===e.op){var p={op:'_get',path:e.from,value:void 0},d=i([p],r);if(d&&'OPERATION_PATH_UNRESOLVABLE'===d.name)throw new o.JsonPatchError('Cannot perform the operation from a path that does not exist','OPERATION_FROM_UNRESOLVABLE',t,e,r)}}function i(e,t,r){try{if(!Array.isArray(e))throw new o.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');if(t)a(c._deepClone(t),c._deepClone(e),r||!0);else{r=r||s;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(t){if(t instanceof o.JsonPatchError)return t;throw t}}var p={strict:!0},d=t(9),l=function(e,t){return d(e,t,p)},c=t(2);o.JsonPatchError=c.PatchError,o.deepClone=c._deepClone;var h={add:function(e,t,o){return e[t]=this.value,{newDocument:o}},remove:function(e,t,o){var r=e[t];return delete e[t],{newDocument:o,removed:r}},replace:function(e,t,o){var r=e[t];return e[t]=this.value,{newDocument:o,removed:r}},move:function(e,t,o){var a=r(o,this.path);a&&(a=c._deepClone(a));var s=n(o,{op:'remove',path:this.from}).removed;return n(o,{op:'add',path:this.path,value:s}),{newDocument:o,removed:a}},copy:function(e,t,o){var a=r(o,this.from);return n(o,{op:'add',path:this.path,value:c._deepClone(a)}),{newDocument:o}},test:function(e,t,o){return{newDocument:o,test:l(e[t],this.value)}},_get:function(e,t,o){return this.value=e[t],{newDocument:o}}},u={add:function(e,t,o){return c.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:o,index:t}},remove:function(e,t,o){var r=e.splice(t,1);return{newDocument:o,removed:r[0]}},replace:function(e,t,o){var r=e[t];return e[t]=this.value,{newDocument:o,removed:r}},move:h.move,copy:h.copy,test:h.test,_get:h._get};o.getValueByPointer=r,o.applyOperation=n,o.applyPatch=a,o.applyReducer=function(e,t){var r=n(e,t);if(!1===r.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,t,e);return r.newDocument},o.validator=s,o.validate=i},function(e,t,o){(function(t){const r='3.1.0',{applyPatch:n,validate:a}=o(32),s=o(37),i=o(3).JSONPatchQueueSynchronous,p=o(3).JSONPatchQueue,d=o(34),l=o(33),c=o(42),h=o(12),{PalindromError:u,PalindromConnectionError:f}=o(41),m=o(43).w3cwebsocket;if(!t.WebSocket&&m)var y=m;else if(t.WebSocket)var y=t.WebSocket;const g=(()=>{function e(e){return e.replace(/^http/i,'ws')}function t(e,t,o){function r(){n=p,a=0,s=!1,clearTimeout(i),i=null}let n,a,s,i;const p=1e3,d=()=>{0==a?(t(0),s=!1,n*=2,e()):(t(a),a-=1e3,setTimeout(d,1e3))};this.triggerReconnection=()=>{s||(a=n,s=!0,d())},this.reconnectNow=()=>{a=0,n=p},this.stopReconnecting=()=>{r(),o()},r()}function o(e,t,o,r){let n,a;this.start=function(){n||(n=setTimeout(()=>{this.notifySend(),e()},o))},this.notifySend=function(){if(clearTimeout(n),n=null,!e)var e=setTimeout(()=>{e=null,t(new f('Timeout has passed and response hasn\'t arrived','Client',this.remoteUrl,'Unknown'))},r)},this.notifyReceive=function(){clearTimeout(a),a=null,this.start()},this.stop=()=>{clearTimeout(n),n=null,clearTimeout(a),a=null}}function m(){this.start=this.stop=this.notifySend=this.notifyReceive=()=>{}}function g(e,t,o,r){return e.xhr(t,'application/json',o,(t)=>{r(t.data),e.useWebSocket&&e.webSocketUpgrade(e.onSocketOpened)})}function b(e){e._ws&&(e._ws.onclose=()=>{},e._ws.close(),e._ws=null)}function v(e,t){e.heartbeat.stop(),t(function(t){e.reconnector.stopReconnecting(),e.debug&&(e.remoteObj=JSON.parse(JSON.stringify(t))),e.queue.reset(t),e.heartbeat.start()})}function P(e){v(e,e.network.establish.bind(e.network))}function E(e){v(e,(t)=>{e.network.reestablish(e.queue.pending,t)})}function O(e,t,o){for(let r=o,n=e.length;r<n;r++)x(e[r].value,t)}function x(e,t){const o=typeof e;if('object'==o)for(const o in e)e.hasOwnProperty(o)&&x(e[o],t);else'number'==o&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&t(new RangeError(`A number that is either bigger than Number.MAX_INTEGER_VALUE or smaller than Number.MIN_INTEGER_VALUE has been encountered in a patch, value is: ${e}`))}function w(e,t){const o=JSON.stringify(t);e.unobserve(),e.heartbeat.notifySend(),e.network.send(o),e.observe()}if('undefined'==typeof j)if('undefined'!=typeof window)var j=window;else var j={};class k{constructor(t,o,r,n,a,s,i,p,d){this.palindrom=t,this.remoteUrl='undefined'!=typeof window&&window.location?new c(o,window.location.href):new c(o),n&&(this.onReceive=n),a&&(this.onSend=a),s&&(this.onConnectionError=s),p&&(this.onFatalError=p),d&&(this.onStateChange=d),i&&(this.onSocketOpened=i),Object.defineProperty(this,'useWebSocket',{get:function(){return r},set:(t)=>{return r=t,!1==t?this._ws&&(this._ws.onclose=function(){this._ws=null},this._ws.close()):!this.wsUrl&&(this.wsUrl=e(this.remoteUrl.href)),r}})}get useWebSocket(){return this._useWebSocket}set useWebSocket(t){return this._useWebSocket=t,!1==t?this._ws&&(this._ws.onclose=()=>{this._ws=null},this._ws.close()):!this.wsUrl&&(this.wsUrl=e(this.remoteUrl.href)),this.useWebSocket}establish(e){g(this,this.remoteUrl.href,null,e)}reestablish(e,t){g(this,`${this.remoteUrl.href}/reconnect`,JSON.stringify(e),t)}send(e){if(this.useWebSocket&&this._ws&&1===this._ws.readyState)this._ws.send(e),this.onSend(e,this._ws.url,'WS');else{const t=this.remoteUrl.href;this.xhr(t,'application/json-patch+json',e,(e,o)=>{this.onReceive(e.data,t,o)})}return this}onReceive(){}onSend(){}onStateChange(){}upgrade(){}webSocketUpgrade(t){this.wsUrl=e(this.remoteUrl.href);const o=this.wsUrl;b(this),this._ws=new y(o),this._ws.onopen=(e)=>{this.onStateChange(this._ws.readyState,o),t&&t(e)},this._ws.onmessage=(e)=>{try{var t=JSON.parse(e.data)}catch(t){return void this.onFatalError(new f(e.data,'Server',this._ws.url,'WS'))}this.onReceive(t,this._ws.url,'WS')},this._ws.onerror=(e)=>{if(this.onStateChange(this._ws.readyState,o,e.data),!!this.useWebSocket){this.onFatalError(new f('\n','Client',o,'WS'))}},this._ws.onclose=(e)=>{if(this.onStateChange(this._ws.readyState,o,null,e.code,e.reason),e.reason){this.onFatalError(new f('WebSocket connection closed unexpectedly.\n\n\n','Server',o,'WS'))}else if(!e.wasClean){this.onConnectionError(new f('WebSocket connection closed unexpectedly.\n\n\n','Server',o,'WS'))}}}getPatchUsingHTTP(e){return this.xhr(e,'application/json-patch+json',null,(t,o)=>{this.onReceive(t.data,e,o)},!0)}changeState(e){return console.warn('Palindrom: changeState was renamed to `getPatchUsingHTTP`, and they\'re both not recommended to use, please use `PalindromDOM.morphUrl` instead'),this.getPatchUsingHTTP(e)}setRemoteUrl(e){if(this.remoteUrlSet&&this.remoteUrl&&this.remoteUrl!=e){const t=['Session lost.','Server replied with a different session ID than the already set one.','Possibly a server restart happened while you were working.','Please reload the page.'`Previous session ID: ${this.remoteUrl}``New session ID: ${e}`].join('\n');throw new u(t)}this.remoteUrlSet=!0,this.remoteUrl=new c(e,this.remoteUrl.href)}handleResponseHeader(e){const t=e.headers&&(e.headers['x-location']||e.headers.location);t&&this.setRemoteUrl(t)}xhr(e,t,o,r,n){const a=o?'PATCH':'GET',s={};let i;o&&(s['Content-Type']='application/json-patch+json'),t&&(s.Accept=t),this.remoteUrl&&n&&(s['X-Referer']=this.remoteUrl.pathname),i='GET'==a?h.get(e,{headers:s}):h.patch(e,o,{headers:s}),i.then((e)=>{this.handleResponseHeader(e),r&&r.call(this.palindrom,e,a)}).catch((t)=>{const o=t.response;if(o)var r=o.status,n=o.statusText||o.data,s=o.data;else{var r=-1,n=`An unknown network error has occurred. Raw message: ${t.message}`,s='Maybe you lost connection with the server';console.error(t)}const i=[n,`statusCode: ${r}`,`reason: ${s}`,`url: ${e}`,`HTTP method: ${a}`].join('\n');this.onFatalError(new f(i,'Client',e,a))}),this.onSend(o,e,a)}}class _{constructor(e,t){this.obj=e,this.apply=t}send(e){return e}receive(e){return this.obj=this.apply(this.obj,e)}reset(e){return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])}}class S{static get version(){return r}constructor(e){if(this.version=r,'object'!=typeof e)throw new TypeError('Palindrom constructor requires an object argument.');if(!e.remoteUrl)throw new TypeError('remoteUrl is required');if(e.ignoreAdd)throw new TypeError('Palindrom: `ignoreAdd` is removed in favour of local state objects. see https://github.com/Palindrom/Palindrom/issues/136');this.debug=void 0==e.debug||e.debug;const n=function(){};if(this.isObserving=!1,this.onLocalChange=e.onLocalChange||n,this.onRemoteChange=e.onRemoteChange||n,this.onStateReset=e.onStateReset||e.callback||n,this.filterLocalChange=e.filterLocalChange||((e)=>e),e.callback&&console.warn('Palindrom: options.callback is deprecated. Please use `onStateReset` instead'),this.onPatchReceived=e.onPatchReceived||n,this.onPatchSent=e.onPatchSent||n,this.onSocketStateChanged=e.onSocketStateChanged||n,this.onConnectionError=e.onConnectionError||n,this.retransmissionThreshold=e.retransmissionThreshold||3,this.onReconnectionCountdown=e.onReconnectionCountdown||n,this.onReconnectionEnd=e.onReconnectionEnd||n,this.onSocketOpened=e.onSocketOpened||n,this.onIncomingPatchValidationError=e.onIncomingPatchValidationError||n,this.onOutgoingPatchValidationError=e.onOutgoingPatchValidationError||n,this.onError=e.onError||n,this.reconnector=new t(()=>E(this),this.onReconnectionCountdown,this.onReconnectionEnd),e.pingIntervalS){const t=1e3*e.pingIntervalS;this.heartbeat=new o(this.ping.bind(this),this.handleConnectionError.bind(this),t,t)}else this.heartbeat=new m;this.network=new k(this,e.remoteUrl,e.useWebSocket||!1,this.handleRemoteChange.bind(this),this.onPatchSent.bind(this),this.handleConnectionError.bind(this),this.onSocketOpened.bind(this),this.handleFatalError.bind(this),this.onSocketStateChanged.bind(this)),this.OTPatchIndexOffset=0,e.localVersionPath?e.remoteVersionPath?(this.OTPatchIndexOffset=2,this.queue=e.ot?new l(this.obj,d.transform,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity):new p(this.obj,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity)):(this.OTPatchIndexOffset=1,this.queue=new i(this.obj,e.localVersionPath,this.validateAndApplySequence.bind(this),e.purity)):this.queue=new _(this.obj,this.validateAndApplySequence.bind(this)),P(this)}set ignoreAdd(e){throw new TypeError('Palindrom: Can\'t set `ignoreAdd`, it is removed in favour of local state objects. see https://github.com/Palindrom/Palindrom/issues/136')}get useWebSocket(){return this.network.useWebSocket}set useWebSocket(e){this.network.useWebSocket=e}ping(){w(this,[])}prepareProxifiedObject(e){e||(e={}),this.jsonPatcherProxy=new s(e);const t=this.jsonPatcherProxy.observe(!1,(e)=>{const t=this.filterLocalChange(e);t&&this.handleLocalChange(t)});Object.defineProperty(this,'obj',{get(){return t},set(){throw new Error('palindrom.obj is readonly')},configurable:!0}),this.isObserving=!0}observe(){this.jsonPatcherProxy&&this.jsonPatcherProxy.resume(),this.isObserving=!0}unobserve(){this.jsonPatcherProxy&&this.jsonPatcherProxy.pause(),this.isObserving=!1}handleLocalChange(e){e.value&&x(e.value,this.onOutgoingPatchValidationError);const t=[e];this.debug&&this.validateSequence(this.remoteObj,t),w(this,this.queue.send(t)),this.onLocalChange(t)}validateAndApplySequence(e,t){try{this.unobserve();const o=n(e,t,this.debug);if(this.observe(),o.newDocument!==e){this.prepareProxifiedObject(o.newDocument),this.queue.obj=this.obj,x(this.obj,this.onIncomingPatchValidationError);try{this.onStateReset(this.obj)}catch(e){this.onError(new u(`Palindrom: Error inside onStateReset callback: ${e.message}`)),console.error(e)}}this.onRemoteChange(t,o)}catch(e){if(this.debug)return void this.onIncomingPatchValidationError(e);throw e}return this.obj}validateSequence(e,t){const o=a(t,e);o&&this.onOutgoingPatchValidationError(o)}handleConnectionError(){this.heartbeat.stop(),this.reconnector.triggerReconnection()}handleFatalError(e){this.heartbeat.stop(),this.reconnector.stopReconnecting(),this.onConnectionError&&this.onConnectionError(e)}reconnectNow(){this.reconnector.reconnectNow()}showWarning(e,t){this.debug&&j.console&&console.warn&&(t&&(e+=` (${t})`),console.warn(`Palindrom warning: ${e}`))}handleRemoteChange(e,t,o){this.heartbeat.notifyReceive();const r=e||[];(O(r,this.onIncomingPatchValidationError,this.OTPatchIndexOffset),0!==r.length)&&(this.onPatchReceived&&this.onPatchReceived(e,t,o),this.isObserving&&(this.queue.receive(r),this.queue.pending&&this.queue.pending.length&&this.queue.pending.length>this.retransmissionThreshold&&this.queue.pending.forEach(w.bind(null,this)),this.debug&&(this.remoteObj=JSON.parse(JSON.stringify(this.obj)))))}}return j.Puppet=S,S})();e.exports=g,e.exports.default=g,e.exports.__esModule=!0}).call(t,o(39))},function(e,t,o){e.exports=o(13)},function(e,t,o){'use strict';function r(e){var t=new s(e),o=a(s.prototype.request,t);return n.extend(o,s.prototype,t),n.extend(o,t),o}var n=o(0),a=o(8),s=o(15),i=o(1),p=r(i);p.Axios=s,p.create=function(e){return r(n.merge(i,e))},p.Cancel=o(5),p.CancelToken=o(14),p.isCancel=o(6),p.all=function(e){return Promise.all(e)},p.spread=o(29),e.exports=p,e.exports.default=p},function(e,t,o){'use strict';function r(e){if('function'!=typeof e)throw new TypeError('executor must be a function.');var t;this.promise=new Promise(function(e){t=e});var o=this;e(function(e){o.reason||(o.reason=new n(e),t(o.reason))})}var n=o(5);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},e.exports=r},function(e,t,o){'use strict';function r(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var n=o(1),a=o(0),s=o(16),i=o(17),p=o(25),d=o(23);r.prototype.request=function(e){'string'==typeof e&&(e=a.merge({url:arguments[0]},arguments[1])),e=a.merge(n,this.defaults,{method:'get'},e),e.baseURL&&!p(e.url)&&(e.url=d(e.baseURL,e.url));var t=[i,void 0],o=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)o=o.then(t.shift(),t.shift());return o},a.forEach(['delete','get','head'],function(e){r.prototype[e]=function(t,o){return this.request(a.merge(o||{},{method:e,url:t}))}}),a.forEach(['post','put','patch'],function(e){r.prototype[e]=function(t,o,r){return this.request(a.merge(r||{},{method:e,url:t,data:o}))}}),e.exports=r},function(e,t,o){'use strict';function r(){this.handlers=[]}var n=o(0);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,o){'use strict';function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var n=o(0),a=o(20),s=o(6),i=o(1);e.exports=function(e){r(e),e.headers=e.headers||{},e.data=a(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(['delete','get','head','post','put','patch','common'],function(t){delete e.headers[t]});var t=e.adapter||i.adapter;return t(e).then(function(t){return r(e),t.data=a(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(r(e),t&&t.response&&(t.response.data=a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e){'use strict';e.exports=function(e,t,o,r){return e.config=t,o&&(e.code=o),e.response=r,e}},function(e,t,o){'use strict';var r=o(7);e.exports=function(e,t,o){var n=o.config.validateStatus;o.status&&n&&!n(o.status)?t(r('Request failed with status code '+o.status,o.config,null,o)):e(o)}},function(e,t,o){'use strict';var r=o(0);e.exports=function(e,t,o){return r.forEach(o,function(o){e=o(e,t)}),e}},function(e){'use strict';function t(){this.message='String contains an invalid character'}t.prototype=new Error,t.prototype.code=5,t.prototype.name='InvalidCharacterError',e.exports=function(e){for(var o,r,n=e+'',a='',s=0,i='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';n.charAt(0|s)||(i='=',s%1);a+=i.charAt(63&o>>8-8*(s%1))){if(r=n.charCodeAt(s+=3/4),255<r)throw new t;o=o<<8|r}return a}},function(e,t,o){'use strict';function r(e){return encodeURIComponent(e).replace(/%40/gi,'@').replace(/%3A/gi,':').replace(/%24/g,'$').replace(/%2C/gi,',').replace(/%20/g,'+').replace(/%5B/gi,'[').replace(/%5D/gi,']')}var n=o(0);e.exports=function(e,t,o){if(!t)return e;var a;if(o)a=o(t);else if(n.isURLSearchParams(t))a=t.toString();else{var s=[];n.forEach(t,function(e,t){null===e||'undefined'==typeof e||(n.isArray(e)&&(t+='[]'),!n.isArray(e)&&(e=[e]),n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+'='+r(e))}))}),a=s.join('&')}return a&&(e+=(-1===e.indexOf('?')?'?':'&')+a),e}},function(e){'use strict';e.exports=function(e,t){return e.replace(/\/+$/,'')+'/'+t.replace(/^\/+/,'')}},function(e,t,o){'use strict';var r=o(0);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,o,n,a,s){var i=[];i.push(e+'='+encodeURIComponent(t)),r.isNumber(o)&&i.push('expires='+new Date(o).toGMTString()),r.isString(n)&&i.push('path='+n),r.isString(a)&&i.push('domain='+a),!0===s&&i.push('secure'),document.cookie=i.join('; ')},read:function(e){var t=document.cookie.match(new RegExp('(^|;\\s*)('+e+')=([^;]*)'));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,'',Date.now()-8.64e7)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e){'use strict';e.exports=function(e){return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,o){'use strict';var r=o(0);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return o&&(n.setAttribute('href',t),t=n.href),n.setAttribute('href',t),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,''):'',host:n.host,search:n.search?n.search.replace(/^\?/,''):'',hash:n.hash?n.hash.replace(/^#/,''):'',hostname:n.hostname,port:n.port,pathname:'/'===n.pathname.charAt(0)?n.pathname:'/'+n.pathname}}var t,o=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement('a');return t=e(window.location.href),function(o){var n=r.isString(o)?e(o):o;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},function(e,t,o){'use strict';var r=o(0);e.exports=function(e,t){r.forEach(e,function(o,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=o,delete e[r])})}},function(e,t,o){'use strict';var r=o(0);e.exports=function(e){var t,o,n,a={};return e?(r.forEach(e.split('\n'),function(e){n=e.indexOf(':'),t=r.trim(e.substr(0,n)).toLowerCase(),o=r.trim(e.substr(n+1)),t&&(a[t]=a[t]?a[t]+', '+o:o)}),a):a}},function(e){'use strict';e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t){function o(e){return'[object Arguments]'==Object.prototype.toString.call(e)}function r(e){return e&&'object'==typeof e&&'number'==typeof e.length&&Object.prototype.hasOwnProperty.call(e,'callee')&&!Object.prototype.propertyIsEnumerable.call(e,'callee')||!1}var n='[object Arguments]'==function(){return Object.prototype.toString.call(arguments)}();t=e.exports=n?o:r,t.supported=o;t.unsupported=r},function(e,t){function o(e){var t=[];for(var o in e)t.push(o);return t}t=e.exports='function'==typeof Object.keys?Object.keys:o,t.shim=o},function(e,t,o){function r(e){for(var t=0,o=f.length;t<o;t++)if(f[t].obj===e)return f[t]}function n(e,t){for(var o=0,r=e.observers.length;o<r;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,r=e.observers.length;o<r;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function s(e){for(var t,o=0,r=f.length;o<r;o++)if(f[o].obj===e.object){t=f[o];break}p(t.value,e.object,e.patches,''),e.patches.length&&c.applyPatch(t.value,e.patches);var n=e.patches;return 0<n.length&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,o,r,n){if(o!==e){'function'==typeof o.toJSON&&(o=o.toJSON());for(var a=l._objectKeys(o),s=l._objectKeys(e),i=!1,d=!1,c=s.length-1;0<=c;c--){var t=s[c],h=e[t];if(l.hasOwnProperty(o,t)&&(void 0!==o[t]||void 0===h||!1!==Array.isArray(o))){var u=o[t];'object'==typeof h&&null!=h&&'object'==typeof u&&null!=u?p(h,u,r,n+'/'+l.escapePathComponent(t)):h!==u&&(i=!0,r.push({op:'replace',path:n+'/'+l.escapePathComponent(t),value:l._deepClone(u)}))}else r.push({op:'remove',path:n+'/'+l.escapePathComponent(t)}),d=!0}if(d||a.length!=s.length)for(var t,c=0;c<a.length;c++)t=a[c],l.hasOwnProperty(e,t)||void 0===o[t]||r.push({op:'add',path:n+'/'+l.escapePathComponent(t),value:l._deepClone(o[t])})}}var i={strict:!0},d=o(9),l=o(2),c=o(10),h=o(10);t.applyOperation=h.applyOperation,t.applyPatch=h.applyPatch,t.applyReducer=h.applyReducer,t.getValueByPointer=h.getValueByPointer,t.validate=h.validate,t.validator=h.validator;var u=o(2);t.JsonPatchError=u.PatchError,t.deepClone=u._deepClone,t.escapePathComponent=u.escapePathComponent,t.unescapePathComponent=u.unescapePathComponent;var f=[],m=function(){return function(e){this.observers=[],this.obj=e}}(),y=function(){return function(e,t){this.callback=e,this.observer=t}}();t.unobserve=function(e,t){t.unobserve()},t.observe=function(e,t){var o,i=r(e);if(i?o=n(i,t):(i=new m(e),f.push(i)),o)return o;if(o={},i.value=l._deepClone(e),t){o.callback=t,o.next=null;var p=function(){s(o)},d=function(){clearTimeout(o.next),o.next=setTimeout(p)};'undefined'!=typeof window&&(window.addEventListener?(window.addEventListener('mouseup',d),window.addEventListener('keyup',d),window.addEventListener('mousedown',d),window.addEventListener('keydown',d),window.addEventListener('change',d)):(document.documentElement.attachEvent('onmouseup',d),document.documentElement.attachEvent('onkeyup',d),document.documentElement.attachEvent('onmousedown',d),document.documentElement.attachEvent('onkeydown',d),document.documentElement.attachEvent('onchange',d)))}return o.patches=[],o.object=e,o.unobserve=function(){s(o),clearTimeout(o.next),a(i,o),'undefined'!=typeof window&&(window.removeEventListener?(window.removeEventListener('mouseup',d),window.removeEventListener('keyup',d),window.removeEventListener('mousedown',d),window.removeEventListener('keydown',d)):(document.documentElement.detachEvent('onmouseup',d),document.documentElement.detachEvent('onkeyup',d),document.documentElement.detachEvent('onmousedown',d),document.documentElement.detachEvent('onkeydown',d)))},i.observers.push(new y(t,o)),o},t.generate=s,t.compare=function(e,t){var o=[];return p(e,t,o,''),o}},function(e,t,o){if('undefined'==typeof r)var r=o(3).JSONPatchQueue;var n=function(e,t,o,n,a){r.call(this,e,o,n,a),this.transform=t,this.pending=[]};n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.ackLocalVersion=0,n.prototype.send=function(e){var t=e.slice(0);t.unshift({op:'test',path:this.remotePath,value:this.remoteVersion});var o=r.prototype.send.call(this,t);return this.pending.push(o),o},n.prototype.receive=function(e,t){var o=t||this.apply,n=this;return r.prototype.receive.call(this,e,function(e,t){var r=t.slice(0),a=r.shift().value,s=a-n.ackLocalVersion;return n.ackLocalVersion=a,n.pending.splice(0,s),n.pending.length&&(r=n.transform(r,n.pending)),n.obj=o(n.obj,r)})},n.prototype.reset=function(e){return this.ackLocalVersion=r.getPropertyByJsonPointer(e,this.localPath),this.pending=[],this.obj=r.prototype.reset.call(this,e)},e.exports=n,e.exports.default=n,e.exports.__esModule=!0},function(e){var t=function(){function e(e,o,r){var n=e.substr(o.length),a=n.indexOf('/');-1<a||(a=n.length);var s=n.substr(0,a),i=n.substr(a);return t(s)&&s>r?o+(s-1)+i:e}function t(e){var t=~~+e;return t+''===e&&0<=t}var o=!1,r=r||{};r.transform=function(e,t){var o=[];o=o.concat.apply(o,t);var r=JSON.parse(JSON.stringify(e)),a=o.reduce(n,r);return a},r.transformAgainstSingleOp=function(){};var n=function(e,t){if(t.value===void 0&&('add'===t.op||'replace'===t.op||'test'===t.op))throw new Error('\'value\' MUST be defined');if(void 0===t.from&&('copy'===t.op||'move'===t.op))throw new Error('\'from\' MUST be defined');if(!a[t.op]);else if('function'==typeof a[t.op])a[t.op](t,e);else for(var o,r=e.length,n=0;n<r;)o=e[n],n++,!a[t.op][o.op]||a[t.op][o.op](t,o);return e},a={remove:function(r,n){for(var a,s=n.length,i=0;a=n[i];)o,('add'===a.op||'test'===a.op)&&r.path===a.path||(a.from&&(a.from===r.path||0===a.from.indexOf(r.path+'/'))||r.path===a.path||0===a.path.indexOf(r.path+'/'))&&(o,n.splice(i,1),s--,i--),i++;var p=r.path.lastIndexOf('/');if(-1<p){var d=r.path.substr(p+1),l=r.path.substr(0,p+1);if(t(d))for(o,o,s=n.length,i=0;i<s;)a=n[i],i++,0===a.path.indexOf(l)&&(a.path=e(a.path,l,d)),a.from&&0===a.from.indexOf(l)&&(a.from=e(a.from,l,d))}},replace:function(e,t){for(var r,n=0;r=t[n];)o,(r.from&&(r.from===e.path||0===r.from.indexOf(e.path+'/'))||0===r.path.indexOf(e.path+'/'))&&(o,t.splice(n,1),n--),n++}};return r}();e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e){var t=function(e,t,o,r){this.obj=e,this.waiting=[],this.versionPath=t,this.apply=o,this.purist=r};t.prototype.version=0,t.prototype.receive=function(e,t){var o=t||this.apply,r=e.slice(0);if(this.purist)r.shift();var n=r.shift(),a=n.value;if(a<=this.version)throw new Error('Given version was already applied.');else if(a==this.version+1)for(;r;)this.version++,this.obj=o(this.obj,r),r=this.waiting.shift();else this.waiting[a-this.version-2]=r},t.prototype.send=function(e){this.version++;var t=e.slice(0);return t.unshift({op:'replace',path:this.versionPath,value:this.version}),this.purist&&t.unshift({op:'test',path:this.versionPath,value:this.version-1}),t},t.getPropertyByJsonPointer=function(e,t){var o=t.split('/');''===o[0]&&o.shift();for(var r=e;o.length;){var n=o.shift().replace('~1','/').replace('~0','~');o.length&&(r=r[n])}return r[n]},t.prototype.reset=function(e){this.version=t.getPropertyByJsonPointer(e,this.versionPath),this.waiting=[];return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])},e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e){var t=function(e,t,o,r){this.obj=e,this.waiting=[],this.localPath=t[0],this.remotePath=t[1],this.apply=o,this.purist=r};t.prototype.localVersion=0,t.prototype.remoteVersion=0,t.prototype.receive=function(e,t){var o=t||this.apply,r=e.slice(0);if(this.purist)r.shift();var n=r.shift(),a=n.value;if(a<=this.remoteVersion)throw new Error('Given version was already applied.');else if(a==this.remoteVersion+1)for(;r;)this.remoteVersion++,this.obj=o(this.obj,r),r=this.waiting.shift();else this.waiting[a-this.remoteVersion-2]=r},t.prototype.send=function(e){this.localVersion++;var t=e.slice(0);return this.purist?t.unshift({op:'test',path:this.localPath,value:this.localVersion-1},{op:'replace',path:this.localPath,value:this.localVersion}):t.unshift({op:'replace',path:this.localPath,value:this.localVersion}),t},t.getPropertyByJsonPointer=function(e,t){var o=t.split('/');''===o[0]&&o.shift();for(var r=e;o.length;){var n=o.shift().replace('~1','/').replace('~0','~');o.length&&(r=r[n])}return r[n]},t.prototype.reset=function(e){this.remoteVersion=t.getPropertyByJsonPointer(e,this.remotePath),this.waiting=[];return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])},e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e){'use strict';const t=function(){function e(e){return-1==e.indexOf('/')&&-1==e.indexOf('~')?e:e.replace(/~/g,'~0').replace(/\//g,'~1')}function t(e,t){const o=[];for(let r=e.parenthoodMap.get(t);r&&r.path;)o.unshift(r.path),r=e.parenthoodMap.get(r.parent);if(o.length){const e=o.join('/');return'/'+e}return''}function o(o,r,n,a){const s=t(o,r),i=s+'/'+e(n);if(o.proxifiedObjectsMap.has(a)){const e=o.proxifiedObjectsMap.get(a);o.parenthoodMap.set(e.originalObject,{parent:r,path:n})}const p=o.proxifiedObjectsMap.get(a);p&&!o.isProxifyingTreeNow&&(p.inherited=!0),a&&'object'==typeof a&&!o.proxifiedObjectsMap.has(a)&&(o.parenthoodMap.set(a,{parent:r,path:n}),a=o._proxifyObjectTreeRecursively(r,a,n));const d={op:'remove',path:i};if('undefined'==typeof a){if(!Array.isArray(r)&&!r.hasOwnProperty(n))return Reflect.set(r,n,a);Array.isArray(r)&&(d.op='replace',d.value=null);const e=o.proxifiedObjectsMap.get(r[n]);e&&(o.parenthoodMap.delete(r[n]),o.disableTrapsForProxy(e),o.proxifiedObjectsMap.delete(e))}else{if(Array.isArray(r)&&!Number.isInteger(+n.toString()))return Reflect.set(r,n,a);d.op='add',r.hasOwnProperty(n)&&('undefined'!=typeof r[n]||Array.isArray(r))&&(d.op='replace'),d.value=a}const l=Reflect.set(r,n,a);return o.defaultCallback(d),l}function r(o,r,n){if('undefined'!=typeof r[n]){const a=t(o,r),s=a+'/'+e(n),i=o.proxifiedObjectsMap.get(r[n]);i&&(i.inherited?i.inherited=!1:(o.parenthoodMap.delete(i.originalObject),o.disableTrapsForProxy(i),o.proxifiedObjectsMap.delete(r[n])));const p=Reflect.deleteProperty(r,n);return o.defaultCallback({op:'remove',path:s}),p}}function n(){this.defaultCallback=(e)=>{this.isRecording&&this.patches.push(e),this.userCallback&&this.userCallback(e)},this.isObserving=!0}function a(){this.defaultCallback=()=>{},this.isObserving=!1}function s(e,t){this.isProxifyingTreeNow=!1,this.isObserving=!1,this.proxifiedObjectsMap=new Map,this.parenthoodMap=new Map,'boolean'!=typeof t&&(t=!0),this.showDetachedWarning=t,this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback,this.resume=n.bind(this),this.pause=a.bind(this)}return s.deepClone=function(e){switch(typeof e){case'object':return JSON.parse(JSON.stringify(e));case'undefined':return null;default:return e;}},s.escapePathComponent=e,s.prototype.generateProxyAtPath=function(e,t,n){if(!t)return t;const a={set:(e,t,r,n)=>o(this,e,t,r,n),deleteProperty:(e,t)=>r(this,e,t)},s=Proxy.revocable(t,a);return s.trapsInstance=a,s.originalObject=t,this.parenthoodMap.set(t,{parent:e,path:n}),this.proxifiedObjectsMap.set(s.proxy,s),s.proxy},s.prototype._proxifyObjectTreeRecursively=function(t,o,r){for(let n in o)o.hasOwnProperty(n)&&o[n]instanceof Object&&(o[n]=this._proxifyObjectTreeRecursively(o,o[n],e(n)));return this.generateProxyAtPath(t,o,r)},s.prototype.proxifyObjectTree=function(e){this.pause(),this.isProxifyingTreeNow=!0;const t=this._proxifyObjectTreeRecursively(void 0,e,'');return this.isProxifyingTreeNow=!1,this.resume(),t},s.prototype.disableTrapsForProxy=function(e){if(this.showDetachedWarning){const t='You\'re accessing an object that is detached from the observedObject tree, see https://github.com/Palindrom/JSONPatcherProxy#detached-objects';e.trapsInstance.set=(e,o,r)=>{return console.warn(t),Reflect.set(e,o,r)},e.trapsInstance.set=(e,o,r)=>{return console.warn(t),Reflect.set(e,o,r)},e.trapsInstance.deleteProperty=(e,t)=>{return Reflect.deleteProperty(e,t)}}else delete e.trapsInstance.set,delete e.trapsInstance.get,delete e.trapsInstance.deleteProperty},s.prototype.observe=function(e,t){if(!e&&!t)throw new Error('You need to either record changes or pass a callback');return this.isRecording=e,this.userCallback=t,e&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(this.originalObject),this.cachedProxy},s.prototype.generate=function(){if(!this.isRecording)throw new Error('You should set record to true to get patches later');return this.patches.splice(0,this.patches.length)},s.prototype.revoke=function(){this.proxifiedObjectsMap.forEach((e)=>{e.revoke()})},s.prototype.disableTraps=function(){this.proxifiedObjectsMap.forEach(this.disableTrapsForProxy,this)},s}();e.exports=t,e.exports.default=t},function(e){function t(){throw new Error('setTimeout has not been defined')}function o(){throw new Error('clearTimeout has not been defined')}function r(e){if(d===setTimeout)return setTimeout(e,0);if((d===t||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function n(e){if(l===clearTimeout)return clearTimeout(e);if((l===o||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){f&&h&&(f=!1,h.length?u=h.concat(u):m=-1,u.length&&s())}function s(){if(!f){var e=r(a);f=!0;for(var t=u.length;t;){for(h=u,u=[];++m<t;)h&&h[m].run();m=-1,t=u.length}h=null,f=!1,n(e)}}function p(e,t){this.fun=e,this.array=t}function i(){}var d,l,c=e.exports={};(function(){try{d='function'==typeof setTimeout?setTimeout:t}catch(o){d=t}try{l='function'==typeof clearTimeout?clearTimeout:o}catch(t){l=o}})();var h,u=[],f=!1,m=-1;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new p(e,t)),1!==u.length||f||r(s)},p.prototype.run=function(){this.fun.apply(null,this.array)},c.title='browser',c.browser=!0,c.env={},c.argv=[],c.version='',c.versions={},c.on=i,c.addListener=i,c.once=i,c.off=i,c.removeListener=i,c.removeAllListeners=i,c.emit=i,c.prependListener=i,c.prependOnceListener=i,c.listeners=function(){return[]},c.binding=function(){throw new Error('process.binding is not supported')},c.cwd=function(){return'/'},c.chdir=function(){throw new Error('process.chdir is not supported')},c.umask=function(){return 0}},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(o){'object'==typeof window&&(t=window)}e.exports=t},function(e,t,o){const r=o(11),n=(()=>{class e extends r{constructor(e){if('object'!=typeof e)throw new Error('PalindromDOM constructor requires an object argument.');if(!e.remoteUrl)throw new Error('remoteUrl is required');const t=e.onStateReset||e.callback;e.callback&&console.warn('Palindrom: options.callback is deprecated. Please use `onStateReset` instead'),e.onStateReset=function(e){this.listen(),t&&t.call(this,e)},super(e),this.element=e.listenTo||document.body,this.clickHandler=this.clickHandler.bind(this),this.historyHandler=this.historyHandler.bind(this),this.morphUrlEventHandler=this.morphUrlEventHandler.bind(this),this.historyHandlerDeprecated=()=>{console.warn('`puppet-redirect-pushstate` event is deprecated, please use `palindrom-redirect-pushstate`, if you\'re using `puppet-redirect`, please upgrade to `palindrom-redirect`'),this.historyHandler()},this.element.addEventListener('palindrom-redirect-pushstate',this.historyHandler),this.element.addEventListener('puppet-redirect-pushstate',this.historyHandlerDeprecated)}listen(){this.listening=!0,this.element.addEventListener('click',this.clickHandler),window.addEventListener('popstate',this.historyHandler),this.element.addEventListener('palindrom-morph-url',this.morphUrlEventHandler),this.element.addEventListener('palindrom-redirect-pushstate',this.historyHandler),this.element.addEventListener('puppet-redirect-pushstate',this.historyHandlerDeprecated)}unlisten(){this.listening=!1,this.element.removeEventListener('click',this.clickHandler),window.removeEventListener('popstate',this.historyHandler),this.element.removeEventListener('palindrom-redirect-pushstate',this.historyHandler),this.element.removeEventListener('palindrom-morph-url',this.morphUrlEventHandler),this.element.removeEventListener('puppet-redirect-pushstate',this.historyHandlerDeprecated)}morphUrl(e){history.pushState(null,null,e),this.network.getPatchUsingHTTP(e),window&&window.scrollTo(0,0)}morphUrlEventHandler(e){this.morphUrl(e.detail.url)}clickHandler(t){if(t.ctrlKey||t.metaKey||2==t.which)return;t.detail&&t.detail.target&&(t=t.detail);let o=t.target;if('A'!==o.nodeName){let e=t.composedPath&&t.composedPath();e||(e=t.path);for(let t=0;t<e.length;t++)if('A'==e[t].nodeName){o=e[t];break}}const r=o.target||o.getAttribute('target'),n=o.hasAttribute('download');if(!n&&(!r||'_self'===r)){const r=o.href||o.getAttribute('href');r&&e.isApplicationLink(r)?(t.preventDefault(),t.stopPropagation(),this.morphUrl(r)):'submit'===o.type&&t.preventDefault()}}historyHandler(){this.network.getPatchUsingHTTP(location.href)}static isApplicationLink(e){if('string'==typeof e){const t=document.createElement('A');t.href=e,''==t.host&&(t.href=t.href),e=t}return e.protocol==window.location.protocol&&e.host==window.location.host}}if(e.prototype=Object.create(r.prototype),'undefined'==typeof t)if('undefined'!=typeof window)var t=window;else var t={};return t.PuppetDOM=e,t.Puppet=r,t.Palindrom=r,e})();e.exports=n,e.exports.default=n,e.exports.__esModule=!0},function(e){class t extends Error{constructor(e){super(e),this.message=e}}e.exports={PalindromError:t,PalindromConnectionError:class extends t{constructor(e,t,o=window.location.href){if(!t||!['Server','Client'].includes(t))throw new TypeError('Error constructing PalindromConnectionError, `side` parameter is required and can either be \'Server\' or \'Client\'');super(e),this.side=t,this.message=`${t} error\n\t${e.replace(/\n/g,'\n\t')}`}}}},function(e){e.exports=URL},function(e){e.exports=WebSocket}]);
//# sourceMappingURL=palindrom-dom.min.js.map