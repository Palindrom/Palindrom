/*! Palindrom, version: 3.0.9 */
var Palindrom=function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(o,'a',o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=41)}([function(e,t,o){'use strict';function n(e){return'[object Array]'===d.call(e)}function r(e){return null!==e&&'object'==typeof e}function a(e){return'[object Function]'===d.call(e)}function s(e,t){if(null!==e&&'undefined'!=typeof e)if('object'==typeof e||n(e)||(e=[e]),n(e))for(var o=0,r=e.length;o<r;o++)t.call(null,e[o],o,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}function i(){function e(e,o){t[o]='object'==typeof t[o]&&'object'==typeof e?i(t[o],e):e}for(var t={},o=0,n=arguments.length;o<n;o++)s(arguments[o],e);return t}var p=o(8),d=Object.prototype.toString;e.exports={isArray:n,isArrayBuffer:function(e){return'[object ArrayBuffer]'===d.call(e)},isFormData:function(e){return'undefined'!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){var t;return t='undefined'!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer,t},isString:function(e){return'string'==typeof e},isNumber:function(e){return'number'==typeof e},isObject:r,isUndefined:function(e){return'undefined'==typeof e},isDate:function(e){return'[object Date]'===d.call(e)},isFile:function(e){return'[object File]'===d.call(e)},isBlob:function(e){return'[object Blob]'===d.call(e)},isFunction:a,isStream:function(e){return r(e)&&a(e.pipe)},isURLSearchParams:function(e){return'undefined'!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return'undefined'!=typeof window&&'undefined'!=typeof document&&'function'==typeof document.createElement},forEach:s,merge:i,extend:function(e,t,o){return s(t,function(t,n){e[n]=o&&'function'==typeof t?p(t,o):t}),e},trim:function(e){return e.replace(/^\s*/,'').replace(/\s*$/,'')}}},function(e,t,o){var n=o(40),r=o(39);e.exports={JSONPatchQueue:n,JSONPatchQueueSynchronous:r,__esModule:!0}},function(e,t,o){'use strict';(function(t){function n(e,t){!r.isUndefined(e)&&r.isUndefined(e['Content-Type'])&&(e['Content-Type']=t)}var r=o(0),a=o(34),s=/^\)\]\}',?\n/,i={"Content-Type":'application/x-www-form-urlencoded'},p={adapter:function(){var e;return'undefined'==typeof XMLHttpRequest?'undefined'!=typeof t&&(e=o(4)):e=o(4),e}(),transformRequest:[function(e,t){return a(t,'Content-Type'),r.isFormData(e)||r.isArrayBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(n(t,'application/x-www-form-urlencoded;charset=utf-8'),e.toString()):r.isObject(e)?(n(t,'application/json;charset=utf-8'),JSON.stringify(e)):e}],transformResponse:[function(e){if('string'==typeof e){e=e.replace(s,'');try{e=JSON.parse(e)}catch(t){}}return e}],timeout:0,xsrfCookieName:'XSRF-TOKEN',xsrfHeaderName:'X-XSRF-TOKEN',maxContentLength:-1,validateStatus:function(e){return 200<=e&&300>e}};p.headers={common:{Accept:'application/json, text/plain, */*'}},r.forEach(['delete','get','head'],function(e){p.headers[e]={}}),r.forEach(['post','put','patch'],function(e){p.headers[e]=r.merge(i)}),e.exports=p}).call(t,o(11))},function(e,t){function o(e,t){return p.call(e,t)}function n(e){if(Array.isArray(e)){for(var t=Array(e.length),n=0;n<t.length;n++)t[n]=''+n;return t}if(Object.keys)return Object.keys(e);var t=[];for(var r in e)o(e,r)&&t.push(r);return t}function r(e){return-1===e.indexOf('/')&&-1===e.indexOf('~')?e:e.replace(/~/g,'~0').replace(/\//g,'~1')}function a(e,t){var n;for(var s in e)if(o(e,s)){if(e[s]===t)return r(s)+'/';if('object'==typeof e[s]&&(n=a(e[s],t),''!=n))return r(s)+'/'+n}return''}function s(e){if(e===void 0)return!0;if(e)if(Array.isArray(e)){for(var t=0,o=e.length;t<o;t++)if(s(e[t]))return!0;}else if('object'==typeof e)for(var r=n(e),a=r.length,t=0;t<a;t++)if(s(e[r[t]]))return!0;return!1}var i=this&&this.__extends||function(e,t){function o(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)},p=Object.prototype.hasOwnProperty;t.hasOwnProperty=o,t._objectKeys=n;t._deepClone=function(e){switch(typeof e){case'object':return JSON.parse(JSON.stringify(e));case'undefined':return null;default:return e;}},t.isInteger=function(e){for(var t,o=0,n=e.length;o<n;){if(t=e.charCodeAt(o),48<=t&&57>=t){o++;continue}return!1}return!0},t.escapePathComponent=r,t.unescapePathComponent=function(e){return e.replace(/~1/g,'/').replace(/~0/g,'~')},t._getPathRecursive=a,t.getPath=function(e,t){if(e===t)return'/';var o=a(e,t);if(''===o)throw new Error('Object not found in root');return'/'+o},t.hasUndefined=s;var d=function(e){function t(t,o,n,r,a){e.call(this,t),this.message=t,this.name=o,this.index=n,this.operation=r,this.tree=a}return i(t,e),t}(Error);t.PatchError=d},function(e,t,o){'use strict';(function(t){var n=o(0),r=o(26),a=o(29),s=o(35),i=o(33),p=o(7),d='undefined'!=typeof window&&window.btoa&&window.btoa.bind(window)||o(28);e.exports=function(e){return new Promise(function(c,l){var h=e.data,u=e.headers;n.isFormData(h)&&delete u['Content-Type'];var f=new XMLHttpRequest,m='onreadystatechange',y=!1;if('test'===t.env.NODE_ENV||'undefined'==typeof window||!window.XDomainRequest||'withCredentials'in f||i(e.url)||(f=new window.XDomainRequest,m='onload',y=!0,f.onprogress=function(){},f.ontimeout=function(){}),e.auth){var g=e.auth.username||'',b=e.auth.password||'';u.Authorization='Basic '+d(g+':'+b)}if(f.open(e.method.toUpperCase(),a(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f[m]=function(){if(f&&(4===f.readyState||y)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf('file:'))){var t='getAllResponseHeaders'in f?s(f.getAllResponseHeaders()):null,o=e.responseType&&'text'!==e.responseType?f.response:f.responseText,n={data:o,status:1223===f.status?204:f.status,statusText:1223===f.status?'No Content':f.statusText,headers:t,config:e,request:f};r(c,l,n),f=null}},f.onerror=function(){l(p('Network Error',e)),f=null},f.ontimeout=function(){l(p('timeout of '+e.timeout+'ms exceeded',e,'ECONNABORTED')),f=null},n.isStandardBrowserEnv()){var v=o(31),P=(e.withCredentials||i(e.url))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;P&&(u[e.xsrfHeaderName]=P)}if('setRequestHeader'in f&&n.forEach(u,function(e,t){'undefined'==typeof h&&'content-type'===t.toLowerCase()?delete u[t]:f.setRequestHeader(t,e)}),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(t){if('json'!==f.responseType)throw t}'function'==typeof e.onDownloadProgress&&f.addEventListener('progress',e.onDownloadProgress),'function'==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener('progress',e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){f&&(f.abort(),l(e),f=null)}),void 0===h&&(h=null),f.send(h)})}}).call(t,o(11))},function(e){'use strict';function t(e){this.message=e}t.prototype.toString=function(){return'Cancel'+(this.message?': '+this.message:'')},t.prototype.__CANCEL__=!0,e.exports=t},function(e){'use strict';e.exports=function(e){return!!(e&&e.__CANCEL__)}},function(e,t,o){'use strict';var n=o(25);e.exports=function(e,t,o,r){var a=new Error(e);return n(a,t,o,r)}},function(e){'use strict';e.exports=function(e,t){return function(){for(var o=Array(arguments.length),n=0;n<o.length;n++)o[n]=arguments[n];return e.apply(t,o)}}},function(e,t,o){function n(e){return null===e||e===void 0}function r(e){return e&&'object'==typeof e&&'number'==typeof e.length&&('function'!=typeof e.copy||'function'!=typeof e.slice?!1:0<e.length&&'number'!=typeof e[0]?!1:!0)}function a(e,t,o){var c,l;if(n(e)||n(t))return!1;if(e.prototype!==t.prototype)return!1;if(p(e))return!!p(t)&&(e=s.call(e),t=s.call(t),d(e,t,o));if(r(e)){if(!r(t))return!1;if(e.length!==t.length)return!1;for(c=0;c<e.length;c++)if(e[c]!==t[c])return!1;return!0}try{var h=i(e),u=i(t)}catch(t){return!1}if(h.length!=u.length)return!1;for(h.sort(),u.sort(),c=h.length-1;0<=c;c--)if(h[c]!=u[c])return!1;for(c=h.length-1;0<=c;c--)if(l=h[c],!d(e[l],t[l],o))return!1;return typeof e==typeof t}var s=Array.prototype.slice,i=o(38),p=o(37),d=e.exports=function(e,t,o){return o||(o={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e&&t&&('object'==typeof e||'object'==typeof t)?a(e,t,o):o.strict?e===t:e==t)}},function(e,o,t){function n(e,t){if(''==t)return e;var o={op:'_get',path:t};return r(e,o),o.value}function r(e,r,a,i){if(void 0===a&&(a=!1),void 0===i&&(i=!0),a&&('function'==typeof a?a(r,0,e,r.path):s(r,0)),''===r.path){var p={newDocument:e};if('add'===r.op)return p.newDocument=r.value,p;if('replace'===r.op)return p.newDocument=r.value,p.removed=e,p;if('move'===r.op||'copy'===r.op)return p.newDocument=n(e,r.from),'move'===r.op&&(p.removed=e),p;if('test'===r.op){if(p.test=c(e,r.value),!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,r,e);return p.newDocument=e,p}if('remove'===r.op)return p.removed=e,p.newDocument=null,p;if('_get'===r.op)return r.value=e,p;if(a)throw new o.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',0,r,e);else return p}else{i||(e=l._deepClone(e));var d,f,m,y=r.path||'',g=y.split('/'),b=e,v=1,t=g.length;for(m='function'==typeof a?a:s;;){if(f=g[v],a&&void 0==d&&(void 0===b[f]?d=g.slice(0,v).join('/'):v==t-1&&(d=r.path),void 0!==d&&m(r,0,e,d)),v++,Array.isArray(b)){if('-'===f)f=b.length;else if(a&&!l.isInteger(f))throw new o.JsonPatchError('Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index','OPERATION_PATH_ILLEGAL_ARRAY_INDEX',0,r.path,r);else l.isInteger(f)&&(f=~~f);if(v>=t){if(a&&'add'===r.op&&f>b.length)throw new o.JsonPatchError('The specified index MUST NOT be greater than the number of elements in the array','OPERATION_VALUE_OUT_OF_BOUNDS',0,r.path,r);var p=u[r.op].call(r,b,f,e);if(!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,r,e);return p}}else if(f&&-1!=f.indexOf('~')&&(f=l.unescapePathComponent(f)),v>=t){var p=h[r.op].call(r,b,f,e);if(!1===p.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,r,e);return p}b=b[f]}}}function a(e,t,n,a){if(void 0===a&&(a=!0),n&&!Array.isArray(t))throw new o.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');a||(e=l._deepClone(e));for(var s=Array(t.length),p=0,i=t.length;p<i;p++)s[p]=r(e,t[p],n),e=s[p].newDocument;return s.newDocument=e,s}function s(e,t,n,r){if('object'!=typeof e||null===e||Array.isArray(e))throw new o.JsonPatchError('Operation is not an object','OPERATION_NOT_AN_OBJECT',t,e,n);else if(!h[e.op])throw new o.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',t,e,n);else if('string'!=typeof e.path)throw new o.JsonPatchError('Operation `path` property is not a string','OPERATION_PATH_INVALID',t,e,n);else if(0!==e.path.indexOf('/')&&0<e.path.length)throw new o.JsonPatchError('Operation `path` property must start with "/"','OPERATION_PATH_INVALID',t,e,n);else if(('move'===e.op||'copy'===e.op)&&'string'!=typeof e.from)throw new o.JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)','OPERATION_FROM_REQUIRED',t,e,n);else if(('add'===e.op||'replace'===e.op||'test'===e.op)&&e.value===void 0)throw new o.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_REQUIRED',t,e,n);else if(('add'===e.op||'replace'===e.op||'test'===e.op)&&l.hasUndefined(e.value))throw new o.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED',t,e,n);else if(n)if('add'==e.op){var a=e.path.split('/').length,s=r.split('/').length;if(a!==s+1&&a!==s)throw new o.JsonPatchError('Cannot perform an `add` operation at the desired path','OPERATION_PATH_CANNOT_ADD',t,e,n)}else if('replace'===e.op||'remove'===e.op||'_get'===e.op){if(e.path!==r)throw new o.JsonPatchError('Cannot perform the operation at a path that does not exist','OPERATION_PATH_UNRESOLVABLE',t,e,n);}else if('move'===e.op||'copy'===e.op){var p={op:'_get',path:e.from,value:void 0},d=i([p],n);if(d&&'OPERATION_PATH_UNRESOLVABLE'===d.name)throw new o.JsonPatchError('Cannot perform the operation from a path that does not exist','OPERATION_FROM_UNRESOLVABLE',t,e,n)}}function i(e,t,n){try{if(!Array.isArray(e))throw new o.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');if(t)a(l._deepClone(t),l._deepClone(e),n||!0);else{n=n||s;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(t){if(t instanceof o.JsonPatchError)return t;throw t}}var p={strict:!0},d=t(9),c=function(e,t){return d(e,t,p)},l=t(3);o.JsonPatchError=l.PatchError,o.deepClone=l._deepClone;var h={add:function(e,t,o){return e[t]=this.value,{newDocument:o}},remove:function(e,t,o){var n=e[t];return delete e[t],{newDocument:o,removed:n}},replace:function(e,t,o){var n=e[t];return e[t]=this.value,{newDocument:o,removed:n}},move:function(e,t,o){var a=n(o,this.path);a&&(a=l._deepClone(a));var s=r(o,{op:'remove',path:this.from}).removed;return r(o,{op:'add',path:this.path,value:s}),{newDocument:o,removed:a}},copy:function(e,t,o){var a=n(o,this.from);return r(o,{op:'add',path:this.path,value:l._deepClone(a)}),{newDocument:o}},test:function(e,t,o){return{newDocument:o,test:c(e[t],this.value)}},_get:function(e,t,o){return this.value=e[t],{newDocument:o}}},u={add:function(e,t,o){return l.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:o,index:t}},remove:function(e,t,o){var n=e.splice(t,1);return{newDocument:o,removed:n[0]}},replace:function(e,t,o){var n=e[t];return e[t]=this.value,{newDocument:o,removed:n}},move:h.move,copy:h.copy,test:h.test,_get:h._get};o.getValueByPointer=n,o.applyOperation=r,o.applyPatch=a,o.applyReducer=function(e,t){var n=r(e,t);if(!1===n.test)throw new o.JsonPatchError('Test operation failed','TEST_OPERATION_FAILED',0,t,e);return n.newDocument},o.validator=s,o.validate=i},function(e){function t(){throw new Error('setTimeout has not been defined')}function o(){throw new Error('clearTimeout has not been defined')}function n(e){if(d===setTimeout)return setTimeout(e,0);if((d===t||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function r(e){if(c===clearTimeout)return clearTimeout(e);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function a(){f&&h&&(f=!1,h.length?u=h.concat(u):m=-1,u.length&&s())}function s(){if(!f){var e=n(a);f=!0;for(var t=u.length;t;){for(h=u,u=[];++m<t;)h&&h[m].run();m=-1,t=u.length}h=null,f=!1,r(e)}}function p(e,t){this.fun=e,this.array=t}function i(){}var d,c,l=e.exports={};(function(){try{d='function'==typeof setTimeout?setTimeout:t}catch(o){d=t}try{c='function'==typeof clearTimeout?clearTimeout:o}catch(t){c=o}})();var h,u=[],f=!1,m=-1;l.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new p(e,t)),1!==u.length||f||n(s)},p.prototype.run=function(){this.fun.apply(null,this.array)},l.title='browser',l.browser=!0,l.env={},l.argv=[],l.version='',l.versions={},l.on=i,l.addListener=i,l.once=i,l.off=i,l.removeListener=i,l.removeAllListeners=i,l.emit=i,l.prependListener=i,l.prependOnceListener=i,l.listeners=function(){return[]},l.binding=function(){throw new Error('process.binding is not supported')},l.cwd=function(){return'/'},l.chdir=function(){throw new Error('process.chdir is not supported')},l.umask=function(){return 0}},function(e,t,o){e.exports=o(20)},function(e,t,o){function n(e){for(var t=0,o=f.length;t<o;t++)if(f[t].obj===e)return f[t]}function r(e,t){for(var o=0,n=e.observers.length;o<n;o++)if(e.observers[o].callback===t)return e.observers[o].observer}function a(e,t){for(var o=0,n=e.observers.length;o<n;o++)if(e.observers[o].observer===t)return void e.observers.splice(o,1)}function s(e){for(var t,o=0,n=f.length;o<n;o++)if(f[o].obj===e.object){t=f[o];break}p(t.value,e.object,e.patches,''),e.patches.length&&l.applyPatch(t.value,e.patches);var r=e.patches;return 0<r.length&&(e.patches=[],e.callback&&e.callback(r)),r}function p(e,o,n,r){if(o!==e){'function'==typeof o.toJSON&&(o=o.toJSON());for(var a=c._objectKeys(o),s=c._objectKeys(e),i=!1,d=!1,l=s.length-1;0<=l;l--){var t=s[l],h=e[t];if(c.hasOwnProperty(o,t)&&(void 0!==o[t]||void 0===h||!1!==Array.isArray(o))){var u=o[t];'object'==typeof h&&null!=h&&'object'==typeof u&&null!=u?p(h,u,n,r+'/'+c.escapePathComponent(t)):h!==u&&(i=!0,n.push({op:'replace',path:r+'/'+c.escapePathComponent(t),value:c._deepClone(u)}))}else n.push({op:'remove',path:r+'/'+c.escapePathComponent(t)}),d=!0}if(d||a.length!=s.length)for(var t,l=0;l<a.length;l++)t=a[l],c.hasOwnProperty(e,t)||void 0===o[t]||n.push({op:'add',path:r+'/'+c.escapePathComponent(t),value:c._deepClone(o[t])})}}var i={strict:!0},d=o(9),c=o(3),l=o(10),h=o(10);t.applyOperation=h.applyOperation,t.applyPatch=h.applyPatch,t.applyReducer=h.applyReducer,t.getValueByPointer=h.getValueByPointer,t.validate=h.validate,t.validator=h.validator;var u=o(3);t.JsonPatchError=u.PatchError,t.deepClone=u._deepClone,t.escapePathComponent=u.escapePathComponent,t.unescapePathComponent=u.unescapePathComponent;var f=[],m=function(){return function(e){this.observers=[],this.obj=e}}(),y=function(){return function(e,t){this.callback=e,this.observer=t}}();t.unobserve=function(e,t){t.unobserve()},t.observe=function(e,t){var o,i=n(e);if(i?o=r(i,t):(i=new m(e),f.push(i)),o)return o;if(o={},i.value=c._deepClone(e),t){o.callback=t,o.next=null;var p=function(){s(o)},d=function(){clearTimeout(o.next),o.next=setTimeout(p)};'undefined'!=typeof window&&(window.addEventListener?(window.addEventListener('mouseup',d),window.addEventListener('keyup',d),window.addEventListener('mousedown',d),window.addEventListener('keydown',d),window.addEventListener('change',d)):(document.documentElement.attachEvent('onmouseup',d),document.documentElement.attachEvent('onkeyup',d),document.documentElement.attachEvent('onmousedown',d),document.documentElement.attachEvent('onkeydown',d),document.documentElement.attachEvent('onchange',d)))}return o.patches=[],o.object=e,o.unobserve=function(){s(o),clearTimeout(o.next),a(i,o),'undefined'!=typeof window&&(window.removeEventListener?(window.removeEventListener('mouseup',d),window.removeEventListener('keyup',d),window.removeEventListener('mousedown',d),window.removeEventListener('keydown',d)):(document.documentElement.detachEvent('onmouseup',d),document.documentElement.detachEvent('onkeyup',d),document.documentElement.detachEvent('onmousedown',d),document.documentElement.detachEvent('onkeydown',d)))},i.observers.push(new y(t,o)),o},t.generate=s,t.compare=function(e,t){var o=[];return p(e,t,o,''),o}},function(e,t,o){if('undefined'==typeof n)var n=o(1).JSONPatchQueue;var r=function(e,t,o,r,a){n.call(this,e,o,r,a),this.transform=t,this.pending=[]};r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype.ackLocalVersion=0,r.prototype.send=function(e){var t=e.slice(0);t.unshift({op:'test',path:this.remotePath,value:this.remoteVersion});var o=n.prototype.send.call(this,t);return this.pending.push(o),o},r.prototype.receive=function(e,t){var o=t||this.apply,r=this;return n.prototype.receive.call(this,e,function(e,t){var n=t.slice(0),a=n.shift().value,s=a-r.ackLocalVersion;return r.ackLocalVersion=a,r.pending.splice(0,s),r.pending.length&&(n=r.transform(n,r.pending)),r.obj=o(r.obj,n)})},r.prototype.reset=function(e){return this.ackLocalVersion=n.getPropertyByJsonPointer(e,this.localPath),this.pending=[],this.obj=n.prototype.reset.call(this,e)},e.exports=r,e.exports.default=r,e.exports.__esModule=!0},function(e){var t=function(){function e(e,o,n){var r=e.substr(o.length),a=r.indexOf('/');-1<a||(a=r.length);var s=r.substr(0,a),i=r.substr(a);return t(s)&&s>n?o+(s-1)+i:e}function t(e){var t=~~+e;return t+''===e&&0<=t}var o=!1,n=n||{};n.transform=function(e,t){var o=[];o=o.concat.apply(o,t);var n=JSON.parse(JSON.stringify(e)),a=o.reduce(r,n);return a},n.transformAgainstSingleOp=function(){};var r=function(e,t){if(t.value===void 0&&('add'===t.op||'replace'===t.op||'test'===t.op))throw new Error('\'value\' MUST be defined');if(void 0===t.from&&('copy'===t.op||'move'===t.op))throw new Error('\'from\' MUST be defined');if(!a[t.op]);else if('function'==typeof a[t.op])a[t.op](t,e);else for(var o,n=e.length,r=0;r<n;)o=e[r],r++,!a[t.op][o.op]||a[t.op][o.op](t,o);return e},a={remove:function(n,r){for(var a,s=r.length,i=0;a=r[i];)o,('add'===a.op||'test'===a.op)&&n.path===a.path||(a.from&&(a.from===n.path||0===a.from.indexOf(n.path+'/'))||n.path===a.path||0===a.path.indexOf(n.path+'/'))&&(o,r.splice(i,1),s--,i--),i++;var p=n.path.lastIndexOf('/');if(-1<p){var d=n.path.substr(p+1),c=n.path.substr(0,p+1);if(t(d))for(o,o,s=r.length,i=0;i<s;)a=r[i],i++,0===a.path.indexOf(c)&&(a.path=e(a.path,c,d)),a.from&&0===a.from.indexOf(c)&&(a.from=e(a.from,c,d))}},replace:function(e,t){for(var n,r=0;n=t[r];)o,(n.from&&(n.from===e.path||0===n.from.indexOf(e.path+'/'))||0===n.path.indexOf(e.path+'/'))&&(o,t.splice(r,1),r--),r++}};return n}();e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e){'use strict';const t=function(){function e(e){return-1==e.indexOf('/')&&-1==e.indexOf('~')?e:e.replace(/~/g,'~0').replace(/\//g,'~1')}function t(e,t){const o=[];for(let n=e.parenthoodMap.get(t);n&&n.path;)o.unshift(n.path),n=e.parenthoodMap.get(n.parent);if(o.length){const e=o.join('/');return'/'+e}return''}function o(o,n,r,a){const s=t(o,n),i=s+'/'+e(r);if(o.proxifiedObjectsMap.has(a)){const e=o.proxifiedObjectsMap.get(a);o.parenthoodMap.set(e.originalObject,{parent:n,path:r})}const p=o.proxifiedObjectsMap.get(a);p&&!o.isProxifyingTreeNow&&(p.inherited=!0),a&&'object'==typeof a&&!o.proxifiedObjectsMap.has(a)&&(o.parenthoodMap.set(a,{parent:n,path:r}),a=o._proxifyObjectTreeRecursively(n,a,r));const d={op:'remove',path:i};if('undefined'==typeof a){if(!Array.isArray(n)&&!n.hasOwnProperty(r))return Reflect.set(n,r,a);Array.isArray(n)&&(d.op='replace',d.value=null);const e=o.proxifiedObjectsMap.get(n[r]);e&&(o.parenthoodMap.delete(n[r]),o.disableTrapsForProxy(e),o.proxifiedObjectsMap.delete(e))}else{if(Array.isArray(n)&&!Number.isInteger(+r.toString()))return Reflect.set(n,r,a);d.op='add',n.hasOwnProperty(r)&&('undefined'!=typeof n[r]||Array.isArray(n))&&(d.op='replace'),d.value=a}const c=Reflect.set(n,r,a);return o.defaultCallback(d),c}function n(o,n,r){if('undefined'!=typeof n[r]){const a=t(o,n),s=a+'/'+e(r),i=o.proxifiedObjectsMap.get(n[r]);i&&(i.inherited?i.inherited=!1:(o.parenthoodMap.delete(i.originalObject),o.disableTrapsForProxy(i),o.proxifiedObjectsMap.delete(n[r])));const p=Reflect.deleteProperty(n,r);return o.defaultCallback({op:'remove',path:s}),p}}function r(){this.defaultCallback=(e)=>{this.isRecording&&this.patches.push(e),this.userCallback&&this.userCallback(e)},this.isObserving=!0}function a(){this.defaultCallback=()=>{},this.isObserving=!1}function s(e,t){this.isProxifyingTreeNow=!1,this.isObserving=!1,this.proxifiedObjectsMap=new Map,this.parenthoodMap=new Map,'boolean'!=typeof t&&(t=!0),this.showDetachedWarning=t,this.originalObject=e,this.cachedProxy=null,this.isRecording=!1,this.userCallback,this.resume=r.bind(this),this.pause=a.bind(this)}return s.deepClone=function(e){switch(typeof e){case'object':return JSON.parse(JSON.stringify(e));case'undefined':return null;default:return e;}},s.escapePathComponent=e,s.prototype.generateProxyAtPath=function(e,t,r){if(!t)return t;const a={set:(e,t,n,r)=>o(this,e,t,n,r),deleteProperty:(e,t)=>n(this,e,t)},s=Proxy.revocable(t,a);return s.trapsInstance=a,s.originalObject=t,this.parenthoodMap.set(t,{parent:e,path:r}),this.proxifiedObjectsMap.set(s.proxy,s),s.proxy},s.prototype._proxifyObjectTreeRecursively=function(t,o,n){for(let r in o)o.hasOwnProperty(r)&&o[r]instanceof Object&&(o[r]=this._proxifyObjectTreeRecursively(o,o[r],e(r)));return this.generateProxyAtPath(t,o,n)},s.prototype.proxifyObjectTree=function(e){this.pause(),this.isProxifyingTreeNow=!0;const t=this._proxifyObjectTreeRecursively(void 0,e,'');return this.isProxifyingTreeNow=!1,this.resume(),t},s.prototype.disableTrapsForProxy=function(e){if(this.showDetachedWarning){const t='You\'re accessing an object that is detached from the observedObject tree, see https://github.com/Palindrom/JSONPatcherProxy#detached-objects';e.trapsInstance.set=(e,o,n)=>{return console.warn(t),Reflect.set(e,o,n)},e.trapsInstance.set=(e,o,n)=>{return console.warn(t),Reflect.set(e,o,n)},e.trapsInstance.deleteProperty=(e,t)=>{return Reflect.deleteProperty(e,t)}}else delete e.trapsInstance.set,delete e.trapsInstance.get,delete e.trapsInstance.deleteProperty},s.prototype.observe=function(e,t){if(!e&&!t)throw new Error('You need to either record changes or pass a callback');return this.isRecording=e,this.userCallback=t,e&&(this.patches=[]),this.cachedProxy=this.proxifyObjectTree(this.originalObject),this.cachedProxy},s.prototype.generate=function(){if(!this.isRecording)throw new Error('You should set record to true to get patches later');return this.patches.splice(0,this.patches.length)},s.prototype.revoke=function(){this.proxifiedObjectsMap.forEach((e)=>{e.revoke()})},s.prototype.disableTraps=function(){this.proxifiedObjectsMap.forEach(this.disableTrapsForProxy,this)},s}();e.exports=t,e.exports.default=t},function(e){var t=function(){return this}();try{t=t||Function('return this')()||(1,eval)('this')}catch(o){'object'==typeof window&&(t=window)}e.exports=t},function(e){e.exports=URL},function(e){e.exports=WebSocket},function(e,t,o){'use strict';function n(e){var t=new s(e),o=a(s.prototype.request,t);return r.extend(o,s.prototype,t),r.extend(o,t),o}var r=o(0),a=o(8),s=o(22),i=o(2),p=n(i);p.Axios=s,p.create=function(e){return n(r.merge(i,e))},p.Cancel=o(5),p.CancelToken=o(21),p.isCancel=o(6),p.all=function(e){return Promise.all(e)},p.spread=o(36),e.exports=p,e.exports.default=p},function(e,t,o){'use strict';function n(e){if('function'!=typeof e)throw new TypeError('executor must be a function.');var t;this.promise=new Promise(function(e){t=e});var o=this;e(function(e){o.reason||(o.reason=new r(e),t(o.reason))})}var r=o(5);n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e,t=new n(function(t){e=t});return{token:t,cancel:e}},e.exports=n},function(e,t,o){'use strict';function n(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var r=o(2),a=o(0),s=o(23),i=o(24),p=o(32),d=o(30);n.prototype.request=function(e){'string'==typeof e&&(e=a.merge({url:arguments[0]},arguments[1])),e=a.merge(r,this.defaults,{method:'get'},e),e.baseURL&&!p(e.url)&&(e.url=d(e.baseURL,e.url));var t=[i,void 0],o=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)o=o.then(t.shift(),t.shift());return o},a.forEach(['delete','get','head'],function(e){n.prototype[e]=function(t,o){return this.request(a.merge(o||{},{method:e,url:t}))}}),a.forEach(['post','put','patch'],function(e){n.prototype[e]=function(t,o,n){return this.request(a.merge(n||{},{method:e,url:t,data:o}))}}),e.exports=n},function(e,t,o){'use strict';function n(){this.handlers=[]}var r=o(0);n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=n},function(e,t,o){'use strict';function n(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var r=o(0),a=o(27),s=o(6),i=o(2);e.exports=function(e){n(e),e.headers=e.headers||{},e.data=a(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(['delete','get','head','post','put','patch','common'],function(t){delete e.headers[t]});var t=e.adapter||i.adapter;return t(e).then(function(t){return n(e),t.data=a(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(n(e),t&&t.response&&(t.response.data=a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e){'use strict';e.exports=function(e,t,o,n){return e.config=t,o&&(e.code=o),e.response=n,e}},function(e,t,o){'use strict';var n=o(7);e.exports=function(e,t,o){var r=o.config.validateStatus;o.status&&r&&!r(o.status)?t(n('Request failed with status code '+o.status,o.config,null,o)):e(o)}},function(e,t,o){'use strict';var n=o(0);e.exports=function(e,t,o){return n.forEach(o,function(o){e=o(e,t)}),e}},function(e){'use strict';function t(){this.message='String contains an invalid character'}t.prototype=new Error,t.prototype.code=5,t.prototype.name='InvalidCharacterError',e.exports=function(e){for(var o,n,r=e+'',a='',s=0,i='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';r.charAt(0|s)||(i='=',s%1);a+=i.charAt(63&o>>8-8*(s%1))){if(n=r.charCodeAt(s+=3/4),255<n)throw new t;o=o<<8|n}return a}},function(e,t,o){'use strict';function n(e){return encodeURIComponent(e).replace(/%40/gi,'@').replace(/%3A/gi,':').replace(/%24/g,'$').replace(/%2C/gi,',').replace(/%20/g,'+').replace(/%5B/gi,'[').replace(/%5D/gi,']')}var r=o(0);e.exports=function(e,t,o){if(!t)return e;var a;if(o)a=o(t);else if(r.isURLSearchParams(t))a=t.toString();else{var s=[];r.forEach(t,function(e,t){null===e||'undefined'==typeof e||(r.isArray(e)&&(t+='[]'),!r.isArray(e)&&(e=[e]),r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(n(t)+'='+n(e))}))}),a=s.join('&')}return a&&(e+=(-1===e.indexOf('?')?'?':'&')+a),e}},function(e){'use strict';e.exports=function(e,t){return e.replace(/\/+$/,'')+'/'+t.replace(/^\/+/,'')}},function(e,t,o){'use strict';var n=o(0);e.exports=n.isStandardBrowserEnv()?function(){return{write:function(e,t,o,r,a,s){var i=[];i.push(e+'='+encodeURIComponent(t)),n.isNumber(o)&&i.push('expires='+new Date(o).toGMTString()),n.isString(r)&&i.push('path='+r),n.isString(a)&&i.push('domain='+a),!0===s&&i.push('secure'),document.cookie=i.join('; ')},read:function(e){var t=document.cookie.match(new RegExp('(^|;\\s*)('+e+')=([^;]*)'));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,'',Date.now()-8.64e7)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e){'use strict';e.exports=function(e){return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,o){'use strict';var n=o(0);e.exports=n.isStandardBrowserEnv()?function(){function e(e){var t=e;return o&&(r.setAttribute('href',t),t=r.href),r.setAttribute('href',t),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,''):'',host:r.host,search:r.search?r.search.replace(/^\?/,''):'',hash:r.hash?r.hash.replace(/^#/,''):'',hostname:r.hostname,port:r.port,pathname:'/'===r.pathname.charAt(0)?r.pathname:'/'+r.pathname}}var t,o=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement('a');return t=e(window.location.href),function(o){var r=n.isString(o)?e(o):o;return r.protocol===t.protocol&&r.host===t.host}}():function(){return function(){return!0}}()},function(e,t,o){'use strict';var n=o(0);e.exports=function(e,t){n.forEach(e,function(o,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=o,delete e[n])})}},function(e,t,o){'use strict';var n=o(0);e.exports=function(e){var t,o,r,a={};return e?(n.forEach(e.split('\n'),function(e){r=e.indexOf(':'),t=n.trim(e.substr(0,r)).toLowerCase(),o=n.trim(e.substr(r+1)),t&&(a[t]=a[t]?a[t]+', '+o:o)}),a):a}},function(e){'use strict';e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t){function o(e){return'[object Arguments]'==Object.prototype.toString.call(e)}function n(e){return e&&'object'==typeof e&&'number'==typeof e.length&&Object.prototype.hasOwnProperty.call(e,'callee')&&!Object.prototype.propertyIsEnumerable.call(e,'callee')||!1}var r='[object Arguments]'==function(){return Object.prototype.toString.call(arguments)}();t=e.exports=r?o:n,t.supported=o;t.unsupported=n},function(e,t){function o(e){var t=[];for(var o in e)t.push(o);return t}t=e.exports='function'==typeof Object.keys?Object.keys:o,t.shim=o},function(e){var t=function(e,t,o,n){this.obj=e,this.waiting=[],this.versionPath=t,this.apply=o,this.purist=n};t.prototype.version=0,t.prototype.receive=function(e,t){var o=t||this.apply,n=e.slice(0);if(this.purist)n.shift();var r=n.shift(),a=r.value;if(a<=this.version)throw new Error('Given version was already applied.');else if(a==this.version+1)for(;n;)this.version++,this.obj=o(this.obj,n),n=this.waiting.shift();else this.waiting[a-this.version-2]=n},t.prototype.send=function(e){this.version++;var t=e.slice(0);return t.unshift({op:'replace',path:this.versionPath,value:this.version}),this.purist&&t.unshift({op:'test',path:this.versionPath,value:this.version-1}),t},t.getPropertyByJsonPointer=function(e,t){var o=t.split('/');''===o[0]&&o.shift();for(var n=e;o.length;){var r=o.shift().replace('~1','/').replace('~0','~');o.length&&(n=n[r])}return n[r]},t.prototype.reset=function(e){this.version=t.getPropertyByJsonPointer(e,this.versionPath),this.waiting=[];return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])},e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e){var t=function(e,t,o,n){this.obj=e,this.waiting=[],this.localPath=t[0],this.remotePath=t[1],this.apply=o,this.purist=n};t.prototype.localVersion=0,t.prototype.remoteVersion=0,t.prototype.receive=function(e,t){var o=t||this.apply,n=e.slice(0);if(this.purist)n.shift();var r=n.shift(),a=r.value;if(a<=this.remoteVersion)throw new Error('Given version was already applied.');else if(a==this.remoteVersion+1)for(;n;)this.remoteVersion++,this.obj=o(this.obj,n),n=this.waiting.shift();else this.waiting[a-this.remoteVersion-2]=n},t.prototype.send=function(e){this.localVersion++;var t=e.slice(0);return this.purist?t.unshift({op:'test',path:this.localPath,value:this.localVersion-1},{op:'replace',path:this.localPath,value:this.localVersion}):t.unshift({op:'replace',path:this.localPath,value:this.localVersion}),t},t.getPropertyByJsonPointer=function(e,t){var o=t.split('/');''===o[0]&&o.shift();for(var n=e;o.length;){var r=o.shift().replace('~1','/').replace('~0','~');o.length&&(n=n[r])}return n[r]},t.prototype.reset=function(e){this.remoteVersion=t.getPropertyByJsonPointer(e,this.remotePath),this.waiting=[];return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])},e.exports=t,e.exports.default=t,e.exports.__esModule=!0},function(e,t,o){(function(t){const n='3.0.9',{applyPatch:r,validate:a}=o(13),s=o(16),i=o(1).JSONPatchQueueSynchronous,p=o(1).JSONPatchQueue,d=o(15),c=o(14),l=o(18),h=o(12),u=o(19).w3cwebsocket;if(!t.WebSocket&&u)var f=u;else if(t.WebSocket)var f=t.WebSocket;const m=(()=>{function e(e){return e.replace(/^http/i,'ws')}function t(e,t,o){function n(){r=p,a=0,s=!1,clearTimeout(i),i=null}let r,a,s,i;const p=1e3,d=()=>{0==a?(t(0),s=!1,r*=2,e()):(t(a),a-=1e3,setTimeout(d,1e3))};this.triggerReconnection=()=>{s||(a=r,s=!0,d())},this.reconnectNow=()=>{a=0,r=p},this.stopReconnecting=()=>{n(),o()},n()}function o(e,t,o,n){let r,a;this.start=function(){r||(r=setTimeout(()=>{this.notifySend(),e()},o))},this.notifySend=function(){clearTimeout(r),r=null,a||(a=setTimeout(()=>{a=null,t()},n))},this.notifyReceive=function(){clearTimeout(a),a=null,this.start()},this.stop=()=>{clearTimeout(r),r=null,clearTimeout(a),a=null}}function u(){this.start=this.stop=this.notifySend=this.notifyReceive=()=>{}}function m(e,t,o,n){return e.xhr(t,'application/json',o,(t)=>{n(t.data),e.useWebSocket&&e.webSocketUpgrade(e.onSocketOpened)})}function y(e){e._ws&&(e._ws.onclose=()=>{},e._ws.close(),e._ws=null)}function g(e,t){e.heartbeat.stop(),t(function(t){e.reconnector.stopReconnecting(),e.debug&&(e.remoteObj=JSON.parse(JSON.stringify(t))),e.queue.reset(t),e.heartbeat.start()})}function b(e){g(e,e.network.establish.bind(e.network))}function v(e){g(e,(t)=>{e.network.reestablish(e.queue.pending,t)})}function P(e,t,o){for(let n=o,r=e.length;n<r;n++)E(e[n].value,t)}function E(e,t){const o=typeof e;if('object'==o)for(const o in e)e.hasOwnProperty(o)&&E(e[o],t);else'number'==o&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&t(new RangeError(`A number that is either bigger than Number.MAX_INTEGER_VALUE or smaller than Number.MIN_INTEGER_VALUE has been encountered in a patch, value is: ${e}`))}function O(e,t){const o=JSON.stringify(t);e.unobserve(),e.heartbeat.notifySend(),e.network.send(o),e.observe()}if('undefined'==typeof x)if('undefined'!=typeof window)var x=window;else var x={};class w{constructor(t,o,n,r,a,s,i,p,d){this.palindrom=t,this.remoteUrl='undefined'!=typeof window&&window.location?new l(o,window.location.href):new l(o),r&&(this.onReceive=r),a&&(this.onSend=a),s&&(this.onConnectionError=s),p&&(this.onFatalError=p),d&&(this.onStateChange=d),i&&(this.onSocketOpened=i),Object.defineProperty(this,'useWebSocket',{get:function(){return n},set:(t)=>{return n=t,!1==t?this._ws&&(this._ws.onclose=function(){this._ws=null},this._ws.close()):!this.wsUrl&&(this.wsUrl=e(this.remoteUrl.href)),n}})}get useWebSocket(){return this._useWebSocket}set useWebSocket(t){return this._useWebSocket=t,!1==t?this._ws&&(this._ws.onclose=()=>{this._ws=null},this._ws.close()):!this.wsUrl&&(this.wsUrl=e(this.remoteUrl.href)),this.useWebSocket}establish(e){m(this,this.remoteUrl.href,null,e)}reestablish(e,t){m(this,`${this.remoteUrl.href}/reconnect`,JSON.stringify(e),t)}send(e){if(this.useWebSocket&&this._ws&&1===this._ws.readyState)this._ws.send(e),this.onSend(e,this._ws.url,'WS');else{const t=this.remoteUrl.href;this.xhr(t,'application/json-patch+json',e,(e,o)=>{this.onReceive(e.data,t,o)})}return this}onReceive(){}onSend(){}onStateChange(){}upgrade(){}webSocketUpgrade(t){this.wsUrl=e(this.remoteUrl.href);const o=this.wsUrl;y(this),this._ws=new f(o),this._ws.onopen=(e)=>{this.onStateChange(this._ws.readyState,o),t&&t(e)},this._ws.onmessage=(e)=>{const t=JSON.parse(e.data);this.onReceive(t,this._ws.url,'WS')},this._ws.onerror=(e)=>{if(this.onStateChange(this._ws.readyState,o,e.data),!!this.useWebSocket){const e={statusText:'WebSocket connection could not be made.',readyState:this._ws.readyState,url:o};this.onFatalError(e,o,'WS')}},this._ws.onclose=(e)=>{this.onStateChange(this._ws.readyState,o,null,e.code,e.reason);const t={statusText:'WebSocket connection closed.',readyState:this._ws.readyState,url:o,statusCode:e.code,reason:e.reason};e.reason?this.onFatalError(t,o,'WS'):!e.wasClean&&this.onConnectionError()}}getPatchUsingHTTP(e){return this.xhr(e,'application/json-patch+json',null,(t,o)=>{this.onReceive(t.data,e,o)},!0)}changeState(e){return console.warn('Palindrom: changeState was renamed to `getPatchUsingHTTP`, and they\'re both not recommended to use, please use `PalindromDOM.morphUrl` instead'),this.getPatchUsingHTTP(e)}setRemoteUrl(e){if(this.remoteUrlSet&&this.remoteUrl&&this.remoteUrl!=e)throw new Error(`Session lost. Server replied with a different session ID that was already set. \nPossibly a server restart happened while you were working. \nPlease reload the page.\n\nPrevious session ID: ${this.remoteUrl}\nNew session ID: ${e}`);this.remoteUrlSet=!0,this.remoteUrl=new l(e,this.remoteUrl.href)}handleResponseHeader(e){const t=e.headers&&(e.headers['x-location']||e.headers.location);t&&this.setRemoteUrl(t)}xhr(e,t,o,n,r){const a=o?'PATCH':'GET',s={};let i;o&&(s['Content-Type']='application/json-patch+json'),t&&(s.Accept=t),this.remoteUrl&&r&&(s['X-Referer']=this.remoteUrl.pathname),i='GET'==a?h.get(e,{headers:s}):h.patch(e,o,{headers:s}),i.then((e)=>{this.handleResponseHeader(e),n&&n.call(this.palindrom,e,a)}).catch((t)=>{const o=t.response;if(o)var n=o.status,r=o.statusText,s=o.data;else{var n=-1,r=`An unknown network error has occurred. Raw message: ${t.message}`,s='Maybe you lost connection with the server';console.error(t)}this.onFatalError({statusCode:n,statusText:r,reason:s},e,a)}),this.onSend(o,e,a)}}class _{constructor(e,t){this.obj=e,this.apply=t}send(e){return e}receive(e){return this.obj=this.apply(this.obj,e)}reset(e){return this.obj=this.apply(this.obj,[{op:'replace',path:'',value:e}])}}class j{static get version(){return n}constructor(e){if(this.version=n,'object'!=typeof e)throw new TypeError('Palindrom constructor requires an object argument.');if(!e.remoteUrl)throw new TypeError('remoteUrl is required');if(e.ignoreAdd)throw new TypeError('Palindrom: `ignoreAdd` is removed in favour of local state objects. see https://github.com/Palindrom/Palindrom/issues/136');this.debug=void 0==e.debug||e.debug;const r=function(){};if(this.isObserving=!1,this.onLocalChange=e.onLocalChange||r,this.onRemoteChange=e.onRemoteChange||r,this.onStateReset=e.onStateReset||e.callback||r,this.filterLocalChange=e.filterLocalChange||((e)=>e),e.callback&&console.warn('Palindrom: options.callback is deprecated. Please use `onStateReset` instead'),this.onPatchReceived=e.onPatchReceived||r,this.onPatchSent=e.onPatchSent||r,this.onSocketStateChanged=e.onSocketStateChanged||r,this.onConnectionError=e.onConnectionError||r,this.retransmissionThreshold=e.retransmissionThreshold||3,this.onReconnectionCountdown=e.onReconnectionCountdown||r,this.onReconnectionEnd=e.onReconnectionEnd||r,this.onSocketOpened=e.onSocketOpened||r,this.onIncomingPatchValidationError=e.onIncomingPatchValidationError||r,this.onOutgoingPatchValidationError=e.onOutgoingPatchValidationError||r,this.reconnector=new t(()=>v(this),this.onReconnectionCountdown,this.onReconnectionEnd),e.pingIntervalS){const t=1e3*e.pingIntervalS;this.heartbeat=new o(this.ping.bind(this),this.handleConnectionError.bind(this),t,t)}else this.heartbeat=new u;this.network=new w(this,e.remoteUrl,e.useWebSocket||!1,this.handleRemoteChange.bind(this),this.onPatchSent.bind(this),this.handleConnectionError.bind(this),this.onSocketOpened.bind(this),this.handleFatalError.bind(this),this.onSocketStateChanged.bind(this)),this.OTPatchIndexOffset=0,e.localVersionPath?e.remoteVersionPath?(this.OTPatchIndexOffset=2,this.queue=e.ot?new c(this.obj,d.transform,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity):new p(this.obj,[e.localVersionPath,e.remoteVersionPath],this.validateAndApplySequence.bind(this),e.purity)):(this.OTPatchIndexOffset=1,this.queue=new i(this.obj,e.localVersionPath,this.validateAndApplySequence.bind(this),e.purity)):this.queue=new _(this.obj,this.validateAndApplySequence.bind(this)),b(this)}set ignoreAdd(e){throw new TypeError('Palindrom: Can\'t set `ignoreAdd`, it is removed in favour of local state objects. see https://github.com/Palindrom/Palindrom/issues/136')}get useWebSocket(){return this.network.useWebSocket}set useWebSocket(e){this.network.useWebSocket=e}ping(){O(this,[])}prepareProxifiedObject(e){e||(e={}),this.jsonPatcherProxy=new s(e);const t=this.jsonPatcherProxy.observe(!1,(e)=>{const t=this.filterLocalChange(e);t&&this.handleLocalChange(t)});Object.defineProperty(this,'obj',{get(){return t},set(){throw new Error('palindrom.obj is readonly')},configurable:!0}),this.isObserving=!0}observe(){this.jsonPatcherProxy&&this.jsonPatcherProxy.resume(),this.isObserving=!0}unobserve(){this.jsonPatcherProxy&&this.jsonPatcherProxy.pause(),this.isObserving=!1}handleLocalChange(e){e.value&&E(e.value,this.onOutgoingPatchValidationError);const t=[e];this.debug&&this.validateSequence(this.remoteObj,t),O(this,this.queue.send(t)),this.onLocalChange(t)}validateAndApplySequence(e,t){try{this.unobserve();const o=r(e,t,this.debug);if(this.observe(),o.newDocument!==e){this.prepareProxifiedObject(o.newDocument),this.queue.obj=this.obj,E(this.obj,this.onIncomingPatchValidationError);try{this.onStateReset(this.obj)}catch(e){e.message=`Palindrom: Error inside onStateReset callback: ${e.message}`,this.onConnectionError(e),console.error(e)}}this.onRemoteChange(t,o)}catch(e){if(this.debug)return void this.onIncomingPatchValidationError(e);throw e}return this.obj}validateSequence(e,t){const o=a(t,e);o&&this.onOutgoingPatchValidationError(o)}handleConnectionError(){this.heartbeat.stop(),this.reconnector.triggerReconnection()}handleFatalError(e,t,o){this.heartbeat.stop(),this.reconnector.stopReconnecting(),this.onConnectionError&&this.onConnectionError(e,t,o)}reconnectNow(){this.reconnector.reconnectNow()}showWarning(e,t){this.debug&&x.console&&console.warn&&(t&&(e+=` (${t})`),console.warn(`Palindrom warning: ${e}`))}handleRemoteChange(e,t,o){this.heartbeat.notifyReceive();const n=e||[];(P(n,this.onIncomingPatchValidationError,this.OTPatchIndexOffset),0!==n.length)&&(this.onPatchReceived&&this.onPatchReceived(e,t,o),this.isObserving&&(this.queue.receive(n),this.queue.pending&&this.queue.pending.length&&this.queue.pending.length>this.retransmissionThreshold&&this.queue.pending.forEach(O.bind(null,this)),this.debug&&(this.remoteObj=JSON.parse(JSON.stringify(this.obj)))))}}return x.Puppet=j,j})();e.exports=m,e.exports.default=m,e.exports.__esModule=!0}).call(t,o(17))}]);